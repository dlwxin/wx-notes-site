(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{598:function(s,a,e){"use strict";e.r(a);var n=e(18),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"links"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#links"}},[s._v("#")]),s._v(" Links")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://docs.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Documentation"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://yeasy.gitbook.io/docker_practice/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker — 从入门到实践"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://docs.docker.com/release-notes/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker release notes"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://docs.docker.com/engine/deprecated/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Deprecated Engine Features"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://catalog.redhat.com/software/containers/search",target:"_blank",rel:"noopener noreferrer"}},[s._v("RedHat Container images"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Hub"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://quay.io/search",target:"_blank",rel:"noopener noreferrer"}},[s._v("Quay.io"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://docs.docker.com/build/building/multi-platform/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Multi-platform images"),e("OutboundLink")],1)])]),s._v(" "),e("h2",{attrs:{id:"environmental-configuration-problem"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#environmental-configuration-problem"}},[s._v("#")]),s._v(" Environmental configuration problem")]),s._v(" "),e("p",[s._v("软件开发最大的麻烦事之一，就是环境配置。用户计算机的环境都不相同，你怎么知道自家的软件，能在那些机器跑起来？")]),s._v(" "),e("p",[s._v("用户必须保证两件事：操作系统的设置，各种库和组件的安装。只有它们都正确，软件才能运行。举例来说，安装一个 Python 应用，计算机必须有 Python 引擎，还必须有各种依赖，可能还要配置环境变量。")]),s._v(" "),e("p",[s._v('如果某些老旧的模块与当前环境不兼容，那就麻烦了。开发者常常会说："它在我的机器可以跑了"（It works on my machine），言下之意就是，其他机器很可能跑不了。')]),s._v(" "),e("p",[s._v("环境配置如此麻烦，换一台机器，就要重来一次，旷日费时。很多人想到，能不能从根本上解决问题，软件可以带环境安装？也就是说，安装的时候，把原始环境一模一样地复制过来。")]),s._v(" "),e("h2",{attrs:{id:"virtual-machine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#virtual-machine"}},[s._v("#")]),s._v(" Virtual machine")]),s._v(" "),e("p",[s._v("虚拟机（virtual machine）就是带环境安装的一种解决方案。它可以在一种操作系统里面运行另一种操作系统，比如在 Windows 系统里面运行 Linux 系统。应用程序对此毫无感知，因为虚拟机看上去跟真实系统一模一样，而对于底层系统来说，虚拟机就是一个普通文件，不需要了就删掉，对其他部分毫无影响。")]),s._v(" "),e("p",[s._v("虽然用户可以通过虚拟机还原软件的原始环境。但是，这个方案有几个缺点。")]),s._v(" "),e("h4",{attrs:{id:"资源占用多"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#资源占用多"}},[s._v("#")]),s._v(" 资源占用多")]),s._v(" "),e("p",[s._v("虚拟机会独占一部分内存和硬盘空间。它运行的时候，其他程序就不能使用这些资源了。哪怕虚拟机里面的应用程序，真正使用的内存只有 1MB，虚拟机依然需要几百 MB 的内存才能运行。")]),s._v(" "),e("h4",{attrs:{id:"冗余步骤多"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#冗余步骤多"}},[s._v("#")]),s._v(" 冗余步骤多")]),s._v(" "),e("p",[s._v("虚拟机是完整的操作系统，一些系统级别的操作步骤，往往无法跳过，比如用户登录。")]),s._v(" "),e("h4",{attrs:{id:"启动慢"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动慢"}},[s._v("#")]),s._v(" 启动慢")]),s._v(" "),e("p",[s._v("启动操作系统需要多久，启动虚拟机就需要多久。可能要等几分钟，应用程序才能真正运行。")]),s._v(" "),e("h2",{attrs:{id:"linux-container"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux-container"}},[s._v("#")]),s._v(" Linux_container")]),s._v(" "),e("p",[s._v("由于虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：Linux 容器（Linux Containers，缩写为 LXC）。")]),s._v(" "),e("p",[s._v("Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。或者说，在正常进程的外面套了一个保护层。对于容器里面的进程来说，它接触到的各种资源都是虚拟的，从而实现与底层系统的隔离。")]),s._v(" "),e("p",[s._v("由于容器是进程级别的，相比虚拟机有很多优势。")]),s._v(" "),e("h4",{attrs:{id:"启动快"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动快"}},[s._v("#")]),s._v(" 启动快")]),s._v(" "),e("p",[s._v("容器里面的应用，直接就是底层系统的一个进程，而不是虚拟机内部的进程。所以，启动容器相当于启动本机的一个进程，而不是启动一个操作系统，速度就快很多。")]),s._v(" "),e("h4",{attrs:{id:"资源占用少"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#资源占用少"}},[s._v("#")]),s._v(" 资源占用少")]),s._v(" "),e("p",[s._v("容器只占用需要的资源，不占用那些没有用到的资源；虚拟机由于是完整的操作系统，不可避免要占用所有资源。另外，多个容器可以共享资源，虚拟机都是独享资源。")]),s._v(" "),e("h4",{attrs:{id:"体积小"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#体积小"}},[s._v("#")]),s._v(" 体积小")]),s._v(" "),e("p",[s._v("容器只要包含用到的组件即可，而虚拟机是整个操作系统的打包，所以容器文件比虚拟机文件要小很多。")]),s._v(" "),e("p",[s._v("总之，容器有点像轻量级的虚拟机，能够提供虚拟化的环境，但是成本开销小得多。")]),s._v(" "),e("h2",{attrs:{id:"what-exactly-is-a-container"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#what-exactly-is-a-container"}},[s._v("#")]),s._v(" What exactly is a container")]),s._v(" "),e("p",[s._v("A container is an executable unit of software in which application code is packaged, along with its libraries and dependencies, in common ways so that it can be run anywhere, whether on a desktop, on-premises, or in the cloud.")]),s._v(" "),e("p",[s._v("Containers are small, fast, and portable because unlike a virtual machine, they do not need to include a guest operating system in every instance and can simply leverage the features and resources of the host operating system instead.")]),s._v(" "),e("p",[s._v("容器是可移植、可执行的轻量级镜像，镜像中包含软件及其相关依赖。")]),s._v(" "),e("h3",{attrs:{id:"容器运行时-container-runtime"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#容器运行时-container-runtime"}},[s._v("#")]),s._v(" 容器运行时（Container Runtime）")]),s._v(" "),e("p",[s._v("容器运行时是负责容器运行的软件")]),s._v(" "),e("h2",{attrs:{id:"what-is-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#what-is-docker"}},[s._v("#")]),s._v(" What is docker")]),s._v(" "),e("p",[e("strong",[s._v("Docker")]),s._v(" 属于 "),e("strong",[s._v("Linux")]),s._v(" 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 "),e("strong",[s._v("Linux")]),s._v(" 容器解决方案。")]),s._v(" "),e("p",[e("strong",[s._v("Docker")]),s._v(" 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样。有了 "),e("strong",[s._v("Docker")]),s._v("，就不用担心环境问题。")]),s._v(" "),e("p",[s._v("总体来说，"),e("strong",[s._v("Docker")]),s._v(" 的接口相当简单，用户可以方便地创建和使用容器，把自己的应用放入容器。容器还可以进行版本管理、复制、分享、修改，就像管理普通的代码一样。")]),s._v(" "),e("h2",{attrs:{id:"use-of-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#use-of-docker"}},[s._v("#")]),s._v(" Use of docker")]),s._v(" "),e("p",[s._v("Docker 的主要用途，目前有三大类。")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("提供一次性的环境。比如，本地测试他人的软件、持续集成的时候提供单元测试和构建的环境。")])]),s._v(" "),e("li",[e("p",[s._v("提供弹性的云服务。因为 Docker 容器可以随开随关，很适合动态扩容和缩容。")])]),s._v(" "),e("li",[e("p",[s._v("组建微服务架构。通过多个容器，一台机器可以跑多个服务，因此在本机就可以模拟出微服务架构。")])])]),s._v(" "),e("h2",{attrs:{id:"image-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#image-file"}},[s._v("#")]),s._v(" Image file")]),s._v(" "),e("p",[e("strong",[s._v("Docker 把应用程序及其依赖，打包在 image 文件里面")]),s._v("。只有通过这个文件，才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。")]),s._v(" "),e("p",[s._v("image 是二进制文件。实际开发中，一个 image 文件往往通过继承另一个 image 文件，加上一些个性化设置而生成。举例来说，你可以在 Ubuntu 的 image 基础上，往里面加入 Apache 服务器，形成你的 image。")]),s._v(" "),e("p",[s._v("Image is a read-only file that contains the resource code, libraries, and dependencies that are needed to run an application.")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出本机的所有 image 文件。")]),s._v("\n$ docker image "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除 image 文件")]),s._v("\n$ docker image "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("imageName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n$ docker rmi "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("imageName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Force removal of the image")]),s._v("\n$ docker rmi -f "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("imageName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("image 文件是通用的，一台机器的 image 文件拷贝到另一台机器，照样可以使用。一般来说，为了节省时间，我们应该尽量使用别人制作好的 image 文件，而不是自己制作。即使要定制，也应该基于别人的 image 文件进行加工，而不是从零开始制作。")]),s._v(" "),e("h2",{attrs:{id:"instance-hello-world"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#instance-hello-world"}},[s._v("#")]),s._v(" Instance: Hello world")]),s._v(" "),e("h3",{attrs:{id:"download-image"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#download-image"}},[s._v("#")]),s._v(" download image")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker image pull library/hello-world\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("上面代码中，"),e("code",[s._v("docker image pull")]),s._v("是抓取 image 文件的命令。"),e("code",[s._v("library/hello-world")]),s._v("是 image 文件在仓库里面的位置，其中"),e("code",[s._v("library")]),s._v("是 image 文件所在的组， "),e("code",[s._v("hello-world")]),s._v("是 image 文件的名字。")]),s._v(" "),e("p",[s._v("由于 Docker 官方提供的 image 文件，都放在"),e("code",[s._v("library")]),s._v("组里面，所以它的是默认组，可以省略。因此，上面的命令可以写成下面这样。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker image pull hello-world\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"select-image"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#select-image"}},[s._v("#")]),s._v(" select image")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker image "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n$ docker images\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"execute-image"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#execute-image"}},[s._v("#")]),s._v(" execute image")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container run hello-world\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("code",[s._v("docker container run")]),s._v("命令会从 image 文件，生成一个正在运行的容器实例。")]),s._v(" "),e("p",[s._v("注意，"),e("code",[s._v("docker container run")]),s._v("命令具有自动抓取 image 文件的功能。如果发现本地没有指定的 image 文件，就会从仓库自动抓取。因此，前面的"),e("code",[s._v("docker image pull")]),s._v("命令并不是必需的步骤。")]),s._v(" "),e("p",[s._v("如果运行成功，你会在屏幕上读到下面的输出。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container run hello-world\n\nHello from Docker"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nThis message shows that your installation appears to be working correctly.\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("输出这段提示以后，"),e("code",[s._v("hello world")]),s._v("就会停止运行，容器自动终止。")]),s._v(" "),e("p",[s._v("有些容器不会自动终止，因为提供的是服务。比如，安装运行 Ubuntu 的 image，就可以在命令行体验 Ubuntu 系统。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container run -it ubuntu "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("对于那些不会自动终止的容器，必须使用"),e("code",[s._v("docker container kill")]),s._v(" 命令手动终止。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"container-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#container-file"}},[s._v("#")]),s._v(" Container file")]),s._v(" "),e("p",[e("strong",[s._v("image 文件生成的容器实例，本身也是一个文件，称为容器文件")]),s._v("。也就是说，一旦容器生成，就会同时存在两个文件： image 文件和容器文件。而且关闭容器并不会删除容器文件，只是容器停止运行而已。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出本机正在运行的容器")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出本机所有容器，包括终止运行的容器")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" --all\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -a\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("上面命令的输出结果之中，包括容器的 ID。很多地方都需要提供这个 ID，比如上一节终止容器运行的"),e("code",[s._v("docker container kill")]),s._v("命令。")]),s._v(" "),e("p",[s._v("终止运行的容器文件，依然会占据硬盘空间，可以使用"),e("code",[s._v("docker container rm")]),s._v("命令删除。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("运行上面的命令之后，再使用"),e("code",[s._v("docker container ls --all")]),s._v("命令，就会发现被删除的容器文件已经消失了。")]),s._v(" "),e("h2",{attrs:{id:"dockerfile-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-file"}},[s._v("#")]),s._v(" Dockerfile file")]),s._v(" "),e("p",[s._v("生成 image 文件, 需要用到 Dockerfile 文件。它是一个文本文件，用来配置 image。Docker 根据 该文件生成二进制的 image 文件。")]),s._v(" "),e("p",[s._v("下面通过一个实例，演示如何编写 Dockerfile 文件。")]),s._v(" "),e("h2",{attrs:{id:"make-docker-container"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#make-docker-container"}},[s._v("#")]),s._v(" Make docker container")]),s._v(" "),e("p",[s._v("以 "),e("strong",[s._v("koa-demos")]),s._v(" 项目为例")]),s._v(" "),e("p",[s._v("作为准备工作，请先"),e("a",{attrs:{href:"https://github.com/ruanyf/koa-demos/archive/master.zip",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载源码"),e("OutboundLink")],1),s._v("。")]),s._v(" "),e("h3",{attrs:{id:"write-a-dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#write-a-dockerfile"}},[s._v("#")]),s._v(" Write a Dockerfile")]),s._v(" "),e("p",[s._v("首先，在项目的根目录下，新建一个文本文件"),e("code",[s._v(".dockerignore")]),s._v("，写入下面的内容。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(".git\nnode_modules\nnpm-debug.log\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("上面代码表示，这三个路径要排除，不要打包进入 image 文件。如果没有路径要排除，这个文件可以不新建。")]),s._v(" "),e("p",[s._v("然后，在项目的根目录下，新建一个文本文件 "),e("code",[s._v("Dockerfile")]),s._v("，写入下面的"),e("a",{attrs:{href:"https://github.com/ruanyf/koa-demos/blob/master/Dockerfile",target:"_blank",rel:"noopener noreferrer"}},[s._v("内容"),e("OutboundLink")],1),s._v("。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("FROM node:8.4\nCOPY . /app\nWORKDIR /app\nRUN npm install --registry=https://registry.npm.taobao.org\nEXPOSE 3000\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("上面代码一共五行，含义如下。")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("FROM node:8.4：该 image 文件继承官方的 node image，冒号表示标签，这里标签是 8.4，即 8.4 版本的 node。")])]),s._v(" "),e("li",[e("p",[s._v("COPY . /app：将当前目录下的所有文件（除了.dockerignore 排除的路径），都拷贝进入 image 文件的/app 目录。")])]),s._v(" "),e("li",[e("p",[s._v("WORKDIR /app：指定接下来的工作路径为/app。")])]),s._v(" "),e("li",[e("p",[s._v("RUN npm install：在/app 目录下，运行 npm install 命令安装依赖。注意，安装后所有的依赖，都将打包进入 image 文件。")])]),s._v(" "),e("li",[e("p",[s._v("EXPOSE 3000：将容器 3000 端口暴露出来， 允许外部连接这个端口。")])])]),s._v(" "),e("blockquote",[e("p",[s._v("Dockerfile 中的 EXPOSE 指令用于向 Docker 守护进程声明容器运行时需要监听的网络端口。它并不会自动将这些端口映射到主机上的任何端口，而是只是向用户以及后续的 Dockerfile 指令传达这个信息。")]),s._v(" "),e("p",[s._v("这个指令可以帮助其他开发人员或者管理员清楚的知道应用程序在容器内部所侦听的端口号。从而更好地配置和管理容器，使其更加高效。通常情况下，我们可以将使用 EXPOSE 指令来记录应用程序的端口，并将应用程序端口映射到主机端口的工作放在 Docker run 命令或 Docker Compose 文件中进行。")]),s._v(" "),e("p",[s._v("请注意，EXPOSE 指令只生效于运行时，而非构建时。它不会自动打开这些端口，也不能代替 Docker run 中 -p 或 -P 参数的作用。如果要将容器内的端口映射到主机上，请在运行容器时，使用 Docker run 命令的 -p 或 -P 选项。")]),s._v(" "),e("p",[s._v("在 Dockerfile 中不使用 EXPOSE 指令不会有任何影响。容器内的应用程序依然可以监听和处理网络请求，只是默认情况下这些端口号对于外部网络是不可访问的。如果需要从外部网络访问容器应用程序提供的服务，那么必须在运行容器时，使用 Docker run 命令的 -p 或 -P 选项进行端口映射或使用其他工具（如 Docker Compose）来实现端口映射。")]),s._v(" "),e("p",[s._v("因此，EXPOSE 并不是必需的，但是它可以帮助其他开发人员或管理员了解容器内应用程序所监听的端口号，以更好地管理、配置容器，同时也可以作为一种文档形式，方便开发人员在编写 Dockerfile 的时候记录和查看应用程序的通信端口。")])]),s._v(" "),e("h3",{attrs:{id:"create-a-image"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-a-image"}},[s._v("#")]),s._v(" Create a image")]),s._v(" "),e("p",[s._v("有了 "),e("strong",[s._v("Dockerfile")]),s._v(" 文件以后，就可以使用"),e("code",[s._v("docker image build")]),s._v("命令创建 image 文件了。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker image build -t koa-demo "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n$ docker image build -t koa-demo:0.0.1 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n$ docker build -t koa-demo:0.0.1 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Do not use cache when building the image")]),s._v("\n$ docker build --no-cache -t koa-demo:0.0.1 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n$ docker build --no-cache --progress"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("plain -t koa-demo:0.0.1 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# BuildKit with Buildx is designed to work well for building for multiple platforms and not only for the architecture and operating system that the user invoking the build happens to run.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# In order to build for a different architecture")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# you can set the --platform flag to specify the target platform for the build output,")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for example, linux/amd64, linux/arm64, or darwin/amd64")]),s._v("\n$ docker buildx build --platform linux/amd64 -t koa-demo:0.0.1 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n$ docker build --platform linux/amd64 -t koa-demo:0.0.1 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n$ docker buildx build --platform linux/amd64,linux/arm64,linux/arm/v7 -t "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":latest --push "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List the existing builders")]),s._v("\n$ docker buildx "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("p",[s._v("上面代码中，"),e("code",[s._v("-t")]),s._v("参数用来指定 image 文件的名字，后面还可以用冒号指定标签。如果不指定，默认的标签就是"),e("code",[s._v("latest")]),s._v("。最后的那个点表示 "),e("strong",[s._v("Dockerfile")]),s._v(" 文件所在的路径，上例是当前路径，所以是一个点。")]),s._v(" "),e("p",[s._v("如果运行成功，就可以看到新生成的 image 文件 "),e("code",[s._v("koa-demo")]),s._v("了。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker image "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n$ docker images\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"build-container"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#build-container"}},[s._v("#")]),s._v(" Build container")]),s._v(" "),e("p",[e("code",[s._v("docker container run")]),s._v("命令会从 image 文件生成容器。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container run -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":3000 -it koa-demo /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n$ docker container run -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":3000 -it koa-demo:0.0.1 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("上面命令的各个参数含义如下：")]),s._v(" "),e("ul",[e("li",[s._v("-p 参数：容器的 3000 端口映射到本机的 8000 端口。")]),s._v(" "),e("li",[s._v("-it 参数：容器的 Shell 映射到当前的 Shell，然后你在本机窗口输入的命令，就会传入容器。")]),s._v(" "),e("li",[s._v("koa-demo:0.0.1：image 文件的名字（如果有标签，还需要提供标签，默认是 latest 标签）。")]),s._v(" "),e("li",[s._v("/bin/bash：容器启动以后，内部第一个执行的命令。这里是启动 Bash，保证用户可以使用 Shell。")])]),s._v(" "),e("p",[s._v("如果一切正常，运行上面的命令以后，就会返回一个命令行提示符。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("root@66d80f4aaf1e:/app"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这表示你已经在容器里面了，返回的提示符就是容器内部的 Shell 提示符。执行下面的命令。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("root@66d80f4aaf1e:/app"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# node demos/01.js")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这时，"),e("strong",[s._v("Koa")]),s._v(' 框架已经运行起来了。打开本机的浏览器，访问 http://127.0.0.1:8000，网页显示"Not Found"，这是因为这个 '),e("a",{attrs:{href:"https://github.com/ruanyf/koa-demos/blob/master/demos/01.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("demo"),e("OutboundLink")],1),s._v(" 没有写路由。")]),s._v(" "),e("p",[s._v("这个例子中，Node 进程运行在 Docker 容器的虚拟环境里面，进程接触到的文件系统和网络接口都是虚拟的，与本机的文件系统和网络接口是隔离的，因此需要定义容器与物理机的端口映射（map）。")]),s._v(" "),e("p",[s._v("现在，在容器的命令行，按下 "),e("strong",[s._v("Ctrl + c 停止 Node 进程")]),s._v("，然后按下 "),e("strong",[s._v("Ctrl + d")]),s._v(" （或者输入 "),e("strong",[s._v("exit")]),s._v("）退出容器。此外，也可以用 "),e("code",[s._v("docker container kill")]),s._v(" 终止容器运行。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在本机的另一个终端窗口，查出容器的 ID")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止指定的容器运行")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("容器停止运行之后，并不会消失，用下面的命令删除容器文件。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查出容器的 ID")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" --all\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定的容器文件")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n$ docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Force the removal of a runnning container(uses SIGKILL)")]),s._v("\n$ docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("也可以使用"),e("code",[s._v("docker container run")]),s._v("命令的"),e("code",[s._v("--rm")]),s._v("参数，在容器终止运行后自动删除容器文件。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container run --rm -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":3000 -it koa-demo /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"cmd-command"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cmd-command"}},[s._v("#")]),s._v(" CMD command")]),s._v(" "),e("p",[s._v("上一节的例子里面，容器启动以后，需要手动输入命令"),e("code",[s._v("node demos/01.js")]),s._v("。我们可以把这个命令写在 "),e("strong",[s._v("Dockerfile")]),s._v(" 里面，这样容器启动以后，这个命令就已经执行了，不用再手动输入了。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("FROM node:8.4\nCOPY "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /app\nWORKDIR /app\nRUN "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --registry"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://registry.npm.taobao.org\nEXPOSE "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\nCMD node demos/01.js\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("上面的 Dockerfile 里面，多了最后一行"),e("code",[s._v("CMD node demos/01.js")]),s._v("，它表示容器启动后自动执行"),e("code",[s._v("node demos/01.js")]),s._v("。")]),s._v(" "),e("p",[s._v("你可能会问，"),e("code",[s._v("RUN")]),s._v("命令与"),e("code",[s._v("CMD")]),s._v("命令的区别在哪里？简单说，"),e("code",[s._v("RUN")]),s._v("命令在 "),e("strong",[s._v("image")]),s._v(" 文件的构建阶段执行，执行结果都会打包进入 "),e("strong",[s._v("image")]),s._v(" 文件；"),e("code",[s._v("CMD")]),s._v("命令则是在容器启动后执行。另外，一个 "),e("strong",[s._v("Dockerfile")]),s._v(" 可以包含多个"),e("code",[s._v("RUN")]),s._v("命令，但是只能有一个"),e("code",[s._v("CMD")]),s._v("命令。")]),s._v(" "),e("p",[s._v("注意，指定了 "),e("code",[s._v("CMD")]),s._v(" 命令以后，"),e("code",[s._v("docker container run")]),s._v(" 命令就不能附加命令了（比如前面的"),e("code",[s._v("/bin/bash")]),s._v("），否则它会覆盖 "),e("code",[s._v("CMD")]),s._v(" 命令。现在，启动容器可以使用下面的命令。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container run --rm -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":3000 -it koa-demo:0.0.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"other-useful-commands"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#other-useful-commands"}},[s._v("#")]),s._v(" Other useful commands")]),s._v(" "),e("p",[s._v("docker 的主要用法就是上面这些，此外还有几个命令，也非常有用。")]),s._v(" "),e("h3",{attrs:{id:"docker-container-start"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-container-start"}},[s._v("#")]),s._v(" docker container start")]),s._v(" "),e("p",[s._v("前面的"),e("code",[s._v("docker container run")]),s._v("命令是新建容器，每运行一次，就会新建一个容器。同样的命令运行两次，就会生成两个一模一样的容器文件。如果希望重复使用容器，就要使用"),e("code",[s._v("docker container start")]),s._v("命令，它用来启动已经生成、已经停止运行的容器文件。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container start "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n$ docker container restart "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"docker-container-stop"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-container-stop"}},[s._v("#")]),s._v(" docker container stop")]),s._v(" "),e("p",[s._v("前面的"),e("code",[s._v("docker container kill")]),s._v("命令终止容器运行，相当于向容器里面的主进程发出 "),e("em",[s._v("SIGKILL")]),s._v(" 信号。而"),e("code",[s._v("docker container stop")]),s._v("命令也是用来终止容器运行，相当于向容器里面的主进程发出 "),e("em",[s._v("SIGTERM")]),s._v(" 信号，然后过一段时间再发出 "),e("em",[s._v("SIGKILL")]),s._v(" 信号。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container stop "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这两个信号的差别是，应用程序收到 "),e("em",[s._v("SIGTERM")]),s._v(" 信号以后，可以自行进行收尾清理工作，但也可以不理会这个信号。如果收到 "),e("em",[s._v("SIGKILL")]),s._v(" 信号，就会强行立即终止，那些正在进行中的操作会全部丢失。")]),s._v(" "),e("h3",{attrs:{id:"docker-container-logs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-container-logs"}},[s._v("#")]),s._v(" docker container logs")]),s._v(" "),e("p",[e("code",[s._v("docker container logs")]),s._v("命令用来查看 docker 容器的输出，即容器里面 Shell 的标准输出。如果"),e("code",[s._v("docker run")]),s._v("命令运行容器的时候，没有使用"),e("code",[s._v("-it")]),s._v("参数，就要用这个命令查看输出。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container logs "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"docker-container-exec"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-container-exec"}},[s._v("#")]),s._v(" docker container exec")]),s._v(" "),e("p",[e("code",[s._v("docker container exec")]),s._v("命令用于进入一个正在运行的 docker 容器。如果"),e("code",[s._v("docker run")]),s._v("命令运行容器的时候，没有使用"),e("code",[s._v("-it")]),s._v("参数，就要用这个命令进入容器。一旦进入了容器，就可以在容器的 Shell 执行命令了。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n$ docker container "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containerID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n\n$ docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n$ docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 7753989ee5p8 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"docker-attach"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-attach"}},[s._v("#")]),s._v(" docker attach")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker run -d --name nginx nginx:1.20.1\ndocker attach nginx\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从这个stdin中exit，会导致容器的停止")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"docker-run"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-run"}},[s._v("#")]),s._v(" docker run")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker run "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --name some-postgres "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -e "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("POSTGRES_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("postgres "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -v /data/db_data/postgresql:/home/data/ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v(":5432 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -d postgres\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --privileged")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用该参数，container内的root拥有真正的root权限。")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 否则，container内的root只是外部的一个普通用户权限。")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# privileged启动的容器，可以看到很多host上的设备，并且可以执行mount。")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 甚至允许你在docker容器中启动docker容器。")]),s._v("\ndocker run --privileged --name some-nginx --rm -d nginx\ndocker run --name some-nginx -v /some/content:/usr/share/nginx/html:ro -d nginx\ndocker run --name some-nginx --rm -d nginx\ndocker run --name some-nginx -- -d nginx\ndocker run --platform linux/amd64 --name some-nginx -- -d nginx\n\ndocker run --privileged --name nginx-manager -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":80 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /home/admin/html/manager/conf/nginx.conf:/etc/nginx/nginx.conf:ro "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /home/admin/html/manager/conf/conf.d:/etc/nginx/conf.d:ro "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /home/admin/html/manager/html:/usr/share/nginx/html:rw "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /home/admin/html/manager/logs:/var/log/nginx -d nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start containers automatically")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://docs.docker.com/config/containers/start-containers-automatically/")]),s._v("\ndocker run -d --restart unless-stopped redis\ndocker run -d --restart"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always redis\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("h3",{attrs:{id:"docker-container-cp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-container-cp"}},[s._v("#")]),s._v(" docker container cp")]),s._v(" "),e("p",[e("code",[s._v("docker container cp")]),s._v("命令用于从正在运行的 Docker 容器里面，将文件拷贝到本机。下面是拷贝到当前目录的写法。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ docker container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("/path/to/file"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n$ docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("containID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("/path/to/file"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"docker-tag"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-tag"}},[s._v("#")]),s._v(" docker tag")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker tag SOURCE_IMAGE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":TAG"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" TARGET_IMAGE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":TAG"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"docker-search"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-search"}},[s._v("#")]),s._v(" docker search")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker search "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("TERM")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"docker-pull"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-pull"}},[s._v("#")]),s._v(" docker pull")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker pull docker.io/library/hello-world:latest\ndocker pull docker.io/hello-world\ndocker pull library/hello-world\ndocker pull hello-world:latest\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Docker Pull (by tag)")]),s._v("\ndocker pull quay.io/bitnami/nginx:1.20.2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Docker Pull (by digest)")]),s._v("\ndocker pull quay.io/bitnami/nginx@sha256:f4ef47ec90907dec48661fc0c386ef0f0602808cf707d8f4546ee3b8272bf7d2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h3",{attrs:{id:"docker-save-and-docker-import"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-save-and-docker-import"}},[s._v("#")]),s._v(" docker save and docker import")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# How to save and import/export docker images")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://foxutech.com/how-to-save-and-import-export-docker-images/")]),s._v("\ndocker save\n\ndocker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v("\n\ndocker load\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"docker-create"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-create"}},[s._v("#")]),s._v(" docker create")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('docker pull nginx:1.20.1\ndocker images | grep nginx*.*1.20.1\nnginx                   1.20.1    c8d03f6b8b91   3 months ago   133MB\n\ndocker create nginx:1.20.1\ndocker ps -a\nCONTAINER ID   IMAGE           COMMAND                  CREATED          STATUS      PORTS                                       NAMES\n8ff46a7b9f5c   nginx:1.20.1    "/docker-entrypoint.…"   35 seconds ago   Created                                                 brave_chandrasekhar\n\ndocker start 8ff46a7b9f5c\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"docker-login"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-login"}},[s._v("#")]),s._v(" docker login")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker login\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\ndocker login docker.io\ndocker login catalog.redhat.com\ndocker login registry.redhat.io\ndocker login container-registry.oracle.com\ndocker login localhost:8080\ndocker login -u "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("password"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("host"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ~/my_password.txt "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" docker login --username foo --password-stdin\ndocker login --username foo --password-stdin "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" ~/my_password\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MY_PASSWORD")]),s._v('"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" docker login --username foo --password-stdin\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Windows")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cmd")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" /p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my_password"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" docker login --username foo --password-stdin\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" password.txt "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" docker login --username foo --password-stdin\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# powershell")]),s._v("\nGet-Content password1.txt "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" docker login --username my_username --password-stdin\n\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("oc get route default-route -n openshift-image-registry --template"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{{ .spec.host }}'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\ndocker login -u "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("oc "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("oc "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),s._v(" -t"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$HOST")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("h3",{attrs:{id:"docker-logout"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-logout"}},[s._v("#")]),s._v(" docker logout")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("logout")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\ndocker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("logout")]),s._v(" docker.io\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\ndocker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("logout")]),s._v(" localhost:8080\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"docker-inspect"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-inspect"}},[s._v("#")]),s._v(" docker inspect")]),s._v(" "),e("p",[s._v("获取容器/镜像的元数据")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("docker inspect "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("container-id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\ndocker inspect "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image-id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器挂在目录")]),s._v("\ndocker inspect "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("container-id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -i mounts -A "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"docker-info"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-info"}},[s._v("#")]),s._v(" docker info")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Display system-wide information")]),s._v("\nClient:\n Context:    default\n Debug Mode: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Plugins:\n  app: Docker App "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.9.1-beta3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  buildx: Docker Buildx "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.7.1-docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  scan: Docker Scan "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.12.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nServer:\n Containers: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n  Running: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n  Paused: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Stopped: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Images: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("38")]),s._v("\n Server Version: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".12\n Storage Driver: overlay2\n  Backing Filesystem: extfs\n  Supports d_type: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  Native Overlay Diff: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  userxattr: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Logging Driver: json-file\n Cgroup Driver: cgroupfs\n Cgroup Version: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Plugins:\n  Volume: "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n  Network: bridge "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" ipvlan macvlan null overlay\n  Log: awslogs fluentd gcplogs gelf journald json-file "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" logentries splunk syslog\n Swarm: inactive\n Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc\n Default Runtime: runc\n Init Binary: docker-init\n containerd version: 7b11cfaabd73bb80907dd23182b9347b4245eb5d\n runc version: v1.0.2-0-g52b36a2\n init version: de40ad0\n Security Options:\n  apparmor\n  seccomp\n   Profile: default\n Kernel Version: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.4")]),s._v(".0-92-generic\n Operating System: Ubuntu "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.04")]),s._v(".3 LTS\n OSType: linux\n Architecture: x86_64\n CPUs: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n Total Memory: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".84GiB\n Name: dlwxin\n ID: PS4W:CKZU:LVV2:IQ5I:2CLA:DJ3I:GCSG:QH7X:J7UN:JKYC:4YUV:7FJX\n Docker Root Dir: /var/lib/docker\n Debug Mode: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Registry: https://index.docker.io/v1/\n Labels:\n Experimental: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Insecure Registries:\n  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.0/8\n Registry Mirrors:\n  https://2rhbup3n.mirror.aliyuncs.com/\n Live Restore Enabled: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br")])]),e("h2",{attrs:{id:"others"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#others"}},[s._v("#")]),s._v(" Others")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Hub"),e("OutboundLink")],1),s._v(" privide one free private repository.")])])}),[],!1,null,null,null);a.default=t.exports}}]);