(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{538:function(e,t,s){"use strict";s.r(t);var a=s(18),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"confluence-is-not-starting-with-mysql-and-confluence-java-11"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#confluence-is-not-starting-with-mysql-and-confluence-java-11"}},[e._v("#")]),e._v(" Confluence is not starting with Mysql and Confluence Java 11")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://confluence.atlassian.com/confkb/confluence-is-not-starting-with-mysql-and-confluence-java-11-1064089758.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Confluence is not starting with Mysql and Confluence Java 11"),s("OutboundLink")],1)])]),e._v(" "),s("h3",{attrs:{id:"summary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#summary"}},[e._v("#")]),e._v(" Summary")]),e._v(" "),s("p",[e._v("Confluence using Java 11 and connected to Mysql Database. As soon as we start Confluence it gives the below error message which is related to Mysql TLS supported version and not appropriated protocol passed via JDBC URL.")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("2021-04-26 03:16:06,441 ERROR [Catalina-utility-1] [confluence.impl.setup.DefaultBootstrapDatabaseAccessor] getBootstrapData Unable to open database connection during bootstrap.\ncom.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet successfully received from the server was 41 milliseconds ago.  The last packet sent successfully to the server was 30 milliseconds ago.\n...\nCaused by: javax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("h3",{attrs:{id:"diagnosis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#diagnosis"}},[e._v("#")]),e._v(" Diagnosis")]),e._v(" "),s("p",[e._v("The error seems to be with MySQL and TLS protocols and this error mentioned in the "),s("a",{attrs:{href:"https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-usagenotes-known-issues-limitations.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("MySQL :: MySQL Connector/J 8.0 Developer Guide :: 16 Known Issues and Limitations:"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Connector/J does not enable connections with TLSv1.2 and higher by default due to compatibility issues when connecting to servers that restrict connections to use those higher TLS versions, you might encounter "),s("strong",[e._v("com.mysql.cj.exceptions.CJCommunicationsException: javax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate).")]),e._v(" You need to enable connections with TLSv1.2 and higher versions using the enabledTLSProtocols connection property. See Section "),s("a",{attrs:{href:"https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-using-ssl.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("6.8, “Connecting Securely Using SSL”"),s("OutboundLink")],1),e._v(" for details.")]),e._v(" "),s("p",[e._v("Java 11 Comes with higher security and the latest TLS versions.")]),e._v(" "),s("p",[e._v("On the server-side, the value of the tls_version system variable determines which TLS protocols a MySQL server permits for encrypted connections. The tls_version value applies to connections from clients and from replica servers using regular source/replica replication. The variable value is a list of one or more comma-separated protocol versions from this list (not case-sensitive): TLSv1, TLSv1.1, TLSv1.2. By default, this variable lists all protocols supported by the SSL library used to compile MySQL (TLSv1,TLSv1.1,TLSv1.2 for OpenSSL, TLSv1,TLSv1.1 for yaSSL). To determine the value of tls_version at runtime, use this statement:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("SHOW GLOBAL VARIABLES LIKE 'tls_version';\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("To change the value of tls_version, set it at server startup. For example, to permit connections that use the TLSv1.1 or TLSv1.2 protocol, but prohibit connections that use the less-secure TLSv1 protocol, use these lines in the server my.cnf file:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("[mysqld]\ntls_version=TLSv1.1,TLSv1.2\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("h3",{attrs:{id:"solution"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#solution"}},[e._v("#")]),e._v(" Solution")]),e._v(" "),s("p",[e._v("To fix this we can pass TLS different versions in JDBC connection URL using enabledTLSProtocols property, like below:")]),e._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("property")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')]),e._v("hibernate.connection.url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("jdbc:mysql://localhost:3306/confluencedb?enabledTLSProtocols=TLSv1,TLSv1.1,TLSv1.2"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("Or Just pass the "),s("strong",[e._v("useSSL=false in Connection string like below, this will not use any TLS version.")])]),e._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("property")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')]),e._v("hibernate.connection.url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("jdbc:mysql://localhost:3306/confluencedb?useSSL=false"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h2",{attrs:{id:"mysql-报错-error-2002-hy000-can-t-connect-to-local-mysql-server-through-socket"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql-报错-error-2002-hy000-can-t-connect-to-local-mysql-server-through-socket"}},[e._v("#")]),e._v(" MySQL 报错：ERROR 2002 (HY000): Can't connect to local MySQL server through socket")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1772444",target:"_blank",rel:"noopener noreferrer"}},[e._v("MySQL 报错：ERROR 2002 (HY000): Can't connect to local MySQL server through socket"),s("OutboundLink")],1)])]),e._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("-- mysql -u root -p")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("-- mysql -h localhost -u root -p")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("-- mysql -h 127.0.0.1 -u root -p")]),e._v("\nsudo mysql "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("h "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("127.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v(".1")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("u root "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("p\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h2",{attrs:{id:"mysql-warning-1681-integer-display-width-is-deprecated"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql-warning-1681-integer-display-width-is-deprecated"}},[e._v("#")]),e._v(" MYSQL - Warning: #1681 Integer display width is deprecated")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/58938358/mysql-warning-1681-integer-display-width-is-deprecated",target:"_blank",rel:"noopener noreferrer"}},[e._v("MYSQL - Warning: #1681 Integer display width is deprecated"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);