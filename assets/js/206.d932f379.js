(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{669:function(e,s,t){"use strict";t.r(s);var a=t(18),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"links"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#links"}},[e._v("#")]),e._v(" Links")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://k3s.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("K3s"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.rancher.cn/k3s",target:"_blank",rel:"noopener noreferrer"}},[e._v("K3s 中文文档"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://www.bilibili.com/video/BV1g7411G7By",target:"_blank",rel:"noopener noreferrer"}},[e._v("B 站：从 0 到 1 基础入门 全面了解 k3s"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/k3s-io/k3s/issues/213",target:"_blank",rel:"noopener noreferrer"}},[e._v("List Containerd images and containers"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://stackoverflow.com/questions/57590030/access-local-docker-images-with-k3s",target:"_blank",rel:"noopener noreferrer"}},[e._v("Access local docker images with k3s"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://stackoverflow.com/questions/74603633/k3s-allow-unauthenticated-access-to-oidc-endpoints",target:"_blank",rel:"noopener noreferrer"}},[e._v("K3s Allow Unauthenticated Access to OIDC Endpoints"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://pgillich.medium.com/setup-lightweight-kubernetes-with-k3s-6a1c57d62217",target:"_blank",rel:"noopener noreferrer"}},[e._v("Setup lightweight Kubernetes with K3s"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/kingsd041/k3s-tutorial",target:"_blank",rel:"noopener noreferrer"}},[e._v("K3s 系列教程"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"快速入门指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速入门指南"}},[e._v("#")]),e._v(" 快速入门指南")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.rancher.cn/docs/k3s/quick-start/_index",target:"_blank",rel:"noopener noreferrer"}},[e._v("快速入门指南"),t("OutboundLink")],1)])]),e._v(" "),t("h3",{attrs:{id:"check-k3s-version"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#check-k3s-version"}},[e._v("#")]),e._v(" Check k3s version")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://update.k3s.io/v1-release/channels",target:"_blank",rel:"noopener noreferrer"}},[e._v("latest/stable/testing"),t("OutboundLink")],1)])]),e._v(" "),t("h3",{attrs:{id:"installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),t("p",[e._v("K3s 提供了一个安装脚本，可以方便的在 systemd 或 openrc 的系统上将其作为服务安装。这个脚本可以在 "),t("a",{attrs:{href:"https://get.k3s.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://get.k3s.io"),t("OutboundLink")],1),e._v(" 获得。")]),e._v(" "),t("p",[e._v("国内用户，可以使用以下方法加速安装：")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("INSTALL_K3S_MIRROR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("cn "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sh")]),e._v(" -\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("INSTALL_K3S_EXEC")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--docker"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("INSTALL_K3S_MIRROR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("cn "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sh")]),e._v(" -\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("INSTALL_K3S_VERSION")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"v1.27.1+k3s1"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("INSTALL_K3S_EXEC")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--docker"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("INSTALL_K3S_MIRROR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("cn "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sh")]),e._v(" -\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("h3",{attrs:{id:"uninstall"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uninstall"}},[e._v("#")]),e._v(" Uninstall")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.rancher.cn/docs/k3s/installation/uninstall/_index",target:"_blank",rel:"noopener noreferrer"}},[e._v("卸载 K3s"),t("OutboundLink")],1)])]),e._v(" "),t("blockquote",[t("p",[e._v("卸载 K3s 会删除集群数据和所有脚本。要使用不同的安装选项重新启动集群，请使用不同的标志重新运行安装脚本。")])]),e._v(" "),t("p",[e._v("要从 server 节点卸载 K3s，请运行：")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("/usr/local/bin/k3s-uninstall.sh\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"access-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#access-cluster"}},[e._v("#")]),e._v(" Access cluster")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.rancher.cn/docs/k3s/cluster-access/_index",target:"_blank",rel:"noopener noreferrer"}},[e._v("集群访问"),t("OutboundLink")],1)])]),e._v(" "),t("p",[e._v("存储在 "),t("code",[e._v("/etc/rancher/k3s/k3s.yaml")]),e._v(" 的 "),t("code",[e._v("kubeconfig")]),e._v(" 文件用于对 Kubernetes 集群的访问。")]),e._v(" "),t("ol",[t("li",[e._v("利用 "),t("code",[e._v("KUBECONFIG")]),e._v(" 环境变量：")])]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("KUBECONFIG")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/etc/rancher/k3s/k3s.yaml\nkubectl get pods --all-namespaces\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("或者在命令中指定 "),t("code",[e._v("kubeconfig")]),e._v(" 文件的位置：")])]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("kubectl --kubeconfig /etc/rancher/k3s/k3s.yaml get pods --all-namespaces\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[e._v("使用 kubectl 从外部访问集群")])]),e._v(" "),t("p",[e._v("将 "),t("code",[e._v("/etc/rancher/k3s/k3s.yaml")]),e._v(" 复制到集群外部的计算机上的 "),t("code",[e._v("~/.kube/config")]),e._v("。然后使用 K3s server 的 IP 或名称替换 server 字段的值。"),t("code",[e._v("kubectl")]),e._v(" 现在可以管理你的 K3s 集群了。")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" /etc/rancher/k3s/k3s.yaml ~/.kube/config\nkubectl get pods --all-namespaces\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("h3",{attrs:{id:"stopping-k3s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#stopping-k3s"}},[e._v("#")]),e._v(" Stopping K3s")]),e._v(" "),t("p",[e._v("To allow high availability during upgrades, the K3s containers continue running when the K3s service is stopped.")]),e._v(" "),t("p",[e._v("To stop all of the K3s containers and reset the containerd state, the "),t("code",[e._v("k3s-killall.sh")]),e._v(" script can be used.")]),e._v(" "),t("p",[e._v("The killall script cleans up containers, K3s directories, and networking components while also removing the iptables chain with all the associated rules. The cluster data will not be deleted.")]),e._v(" "),t("p",[e._v("To run the killall script from a server node, run:")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("/usr/local/bin/k3s-killall.sh\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"k3s-certificate-location"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#k3s-certificate-location"}},[e._v("#")]),e._v(" k3s certificate location")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("su")]),e._v(" -\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /var/lib/rancher/k3s/server/tls\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("ls")]),e._v("\nclient-admin.crt       client-ca.key                    client-k3s-cloud-controller.key  client-kubelet.key     dynamic-cert.json      server-ca.key               serving-kube-apiserver.key\nclient-admin.key       client-ca.nochain.crt            client-k3s-controller.crt        client-kube-proxy.crt  etcd                   server-ca.nochain.crt       serving-kubelet.key\nclient-auth-proxy.crt  client-controller.crt            client-k3s-controller.key        client-kube-proxy.key  request-header-ca.crt  service.current.key         temporary-certs\nclient-auth-proxy.key  client-controller.key            client-kube-apiserver.crt        client-scheduler.crt   request-header-ca.key  service.key\nclient-ca.crt          client-k3s-cloud-controller.crt  client-kube-apiserver.key        client-scheduler.key   server-ca.crt          serving-kube-apiserver.crt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);