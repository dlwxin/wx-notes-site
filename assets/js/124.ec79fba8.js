(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{589:function(s,a,t){"use strict";t.r(a);var n=t(18),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("ul",[t("li",[t("a",{attrs:{href:"https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/msiexec",target:"_blank",rel:"noopener noreferrer"}},[s._v("msiexec"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"overview"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[s._v("#")]),s._v(" Overview")]),s._v(" "),t("p",[s._v("提供从命令行在 Windows Installer 上安装、修改和执行操作的方法。")]),s._v(" "),t("p",[s._v("Msiexec.exe 程序是 Windows Installer 的一个组件。该程序使用动态链接库 Msi.dll 读取程序包文件 (.msi)、应用转换 (.mst) 以及合并命令行选项。该安装程序执行所有与安装相关的任务：将文件复制到硬盘、修改注册表、创建桌面快捷方式以及必要时显示查询用户安装首选项的对话框。")]),s._v(" "),t("p",[s._v("在计算机上安装 Windows Installer 时，将修改操作系统的文件关联功能以便识别 .msi 文件类型。当用户双击带 .msi 扩展名的文件时，操作系统将 .msi 文件与 Windows Installer 关联并运行 Msiexec.exe 应用程序。")]),s._v(" "),t("h2",{attrs:{id:"msiexec-command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#msiexec-command"}},[s._v("#")]),s._v(" "),t("code",[s._v("msiexec")]),s._v(" command")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("msiexec.exe [/i][/a][/j{u|m|/g|/t}][/x] <path_to_package>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-batch line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("msiexec")]),s._v(".exe "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/i")]),s._v(" https://awscli.amazonaws.com/AWSCLIV2.msi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("msiexec")]),s._v(".exe "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/i")]),s._v(" https://awscli.amazonaws.com/AWSCLIV2.msi "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/qn")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("msiexec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/a")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%USERPROFILE%")]),s._v("/Downloads/AWSCLIV2.msi "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/qb")]),s._v(" TARGETDIR="),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("%USERPROFILE%")]),s._v("\\awscli")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"msiexec-help"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#msiexec-help"}},[s._v("#")]),s._v(" "),t("code",[s._v("msiexec --help")])]),s._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("Click me to view detail")]),s._v(" "),t("div",{staticClass:"language-batch line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-batch"}},[t("code",[t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("msiexec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("--help")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Windows")]),s._v(" ® Installer. V "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("."),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("."),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22000")]),s._v("."),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1165")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("msiexec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[s._v("/Option")]),s._v(" <Required Parameter> [Optional Parameter]")]),s._v("\n\n安装选项\n\t</package | /i> <Product.msi>\n\t\t安装或配置产品\n\t/a <Product.msi>\n\t\t管理安装 - 在网络上安装产品\n\t/j<u|m> <Product.msi> [/t <Transform List>] [/g <Language ID>]\n\t\t公布产品 - m 公布到所有用户，u 公布到当前用户\n\t</uninstall | /x> <Product.msi | ProductCode>\n\t\t卸载产品\n显示选项\n\t/quiet\n\t\t安静模式，无用户交互\n\t/passive\n\t\t无人参与模式 - 只显示进度栏\n\t/q[n|b|r|f]\n\t\t设置用户界面级别\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("n")]),s._v(" - 无用户界面")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("b")]),s._v(" - 基本界面")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("r")]),s._v(" - 精简界面")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("f")]),s._v(" - 完整界面(默认值")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t/help\n\t\t帮助信息\n重新启动选项\n\t/norestart\n\t\t安装完成后不重新启动\n\t/promptrestart\n\t\t必要时提示用户重新启动\n\t/forcerestart\n\t\t安装后始终重新启动计算机\n日志选项\n\t/l[i|w|e|a|r|u|c|m|o|p|v|x|+|!|*] <LogFile>\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("i")]),s._v(" - 状态消息")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("w")]),s._v(" - 非致命警告")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("e")]),s._v(" - 所有错误消息")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("a")]),s._v(" - 操作的启动")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("r")]),s._v(" - 操作特定记录")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("u")]),s._v(" - 用户请求")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("c")]),s._v(" - 初始用户界面参数")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("m")]),s._v(" - 内存不足或致命退出信息")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("o")]),s._v(" - 磁盘空间不足消息")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("p")]),s._v(" - 终端属性")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("v")]),s._v(" - 详细输出")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("x")]),s._v(" - 额外调试信息")]),s._v("\n\t\t+ - 扩展到现有日志文件\n\t\t! - 每一行刷新到日志\n\t\t* - 记录所有信息，除了 v 和 x 选项\n\t/log <LogFile>\n\t\t与 /l* <LogFile> 相同\n更新选项\n\t/update <Update1.msp>[;Update2.msp]\n\t\t应用更新\n\t/uninstall <PatchCodeGuid>[;Update2.msp] /package <Product.msi | ProductCode>\n\t\t删除产品的更新\n修复选项\n\t/f[p|e|c|m|s|o|d|a|u|v] <Product.msi | ProductCode>\n\t\t修复产品\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("p")]),s._v(" - 仅当文件丢失时")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("o")]),s._v(" - 如果文件丢失或安装了更旧的版本(默认值")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("e")]),s._v(" - 如果文件丢失或安装了相同或更旧的版本")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("d")]),s._v(" - 如果文件丢失或安装了不同版本")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("c")]),s._v(" - 如果文件丢失或较验和与计算的值不匹配")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("a")]),s._v(" - 强制重新安装所有文件")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("u")]),s._v(" - 所有必要的用户特定注册表项(默认值")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("m")]),s._v(" - 所有必要的计算机特定注册表项(默认值")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("s")]),s._v(" - 所有现有的快捷键方式(默认值")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("v")]),s._v(" - 从源运行并重新缓存本地安装包")]),s._v("\n设置公共属性\n\t[PROPERTY=PropertyValue]\n\n请查阅 Windows "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("R")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installer SDK 获得有关命令行语法的其他文档。\n\n版权所有 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token command"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("C")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Microsoft Corporation. 保留所有权利。\n此软件的部分内容系基于 Independent JPEG Group 的工作。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);