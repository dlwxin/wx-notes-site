(window.webpackJsonp=window.webpackJsonp||[]).push([[204],{666:function(e,t,a){"use strict";a.r(t);var s=a(18),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"links"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#links"}},[e._v("#")]),e._v(" Links")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/zh-cn/blog/2022/05/03/dockershim-historical-context/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockershim：历史背景"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"kubeflow"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubeflow"}},[e._v("#")]),e._v(" kubeflow")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.kubeflow.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubeflow"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"kubetail"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubetail"}},[e._v("#")]),e._v(" kubetail")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/johanhaleby/kubetail",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubetail"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"kubelogin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubelogin"}},[e._v("#")]),e._v(" kubelogin")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/int128/kubelogin",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubelogin"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("kubectl plugin for Kubernetes OpenID Connect authentication (kubectl oidc-login)")]),e._v(" "),a("h2",{attrs:{id:"kubectl-apply-vs-kubectl-create"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl-apply-vs-kubectl-create"}},[e._v("#")]),e._v(" kubectl apply vs kubectl create")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/47369351/kubectl-apply-vs-kubectl-create",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubectl apply vs kubectl create?"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/textdemo123/article/details/104400985",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubernetes: kubectl create 与 kubectl apply 的区别"),a("OutboundLink")],1)])]),e._v(" "),a("ol",[a("li",[a("code",[e._v("kubectl apply")]),e._v(" 可以从 URL 中创建资源（支持 https 协议）， "),a("code",[e._v("kubectl create")]),e._v(" 不可以")])]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("kubectl apply -f https://git.io/vPieo\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[e._v("kubectl create")]),e._v(" 命令可创建新资源。 如果再次运行该命令，则会抛出错误，因为资源名称在名称空间中应该是唯一的。 "),a("code",[e._v("kubectl apply")]),e._v("命令将配置应用于资源。 如果资源不在那里，那么它将被创建。 "),a("code",[e._v("kubectl apply")]),e._v("命令可以第二次运行")])]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl create -f nginx.yaml\npod/nginx created\n\n$ kubectl create -f nginx.yaml\nError from server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("AlreadyExists"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(": error when creating "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"nginx.yaml"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" pods "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"nginx"')]),e._v(" already exists\n\n$ kubectl apply -f nginx.yaml\nWarning: resource pods/nginx is missing the kubectl.kubernetes.io/last-applied-configuration annotation "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("which")]),e._v(" is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create --save-config or kubectl apply. The missing annotation will be patched automatically.\npod/nginx configured\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ kubectl get po\nNo Resources found "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" default namespace\n$ kubectl apply -f nginx.yaml\npod/nginx created\n$ kubectl apply -f nginx.yaml\npod/nginx unchanged\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br")])]),a("h2",{attrs:{id:"对于同一个容器-同类型的资源-resources-requests-和-resources-limits-数值说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对于同一个容器-同类型的资源-resources-requests-和-resources-limits-数值说明"}},[e._v("#")]),e._v(" 对于同一个容器，同类型的资源 resources.requests 和 resources.limits 数值说明")]),e._v(" "),a("ul",[a("li",[e._v("如果同时设置了 limits 和 requests，requests 必须小于等于 limits。")]),e._v(" "),a("li",[e._v("如果只设置了 limits，requests 默认等于 limits。")]),e._v(" "),a("li",[e._v("如果只设置了 requests，容器可使用最大资源量为当前 worker 节点的剩余量。")]),e._v(" "),a("li",[e._v("Pod 对特定资源类型的 requests/limits 值是 Pod 中各容器对该类型资源的 requests/limits 值的总和。")])]),e._v(" "),a("p",[e._v("Kubernetes 中的一个 cpu 等于：")]),e._v(" "),a("ol",[a("li",[e._v("AWS vCPU")]),e._v(" "),a("li",[e._v("GCP Core")]),e._v(" "),a("li",[e._v("Azure vCore")]),e._v(" "),a("li",[e._v("Hyperthread 在带有超线程的裸机 Intel 处理器上")])]),e._v(" "),a("p",[e._v("允许浮点数请求。具有 "),a("code",[e._v("spec.containers[].resources.requests.cpu")]),e._v(" 为 0.5 的容器保证了一半 CPU 要求 1 CPU 的一半。表达式 "),a("code",[e._v("0.1")]),e._v(" 等价于表达式 "),a("code",[e._v("100m")]),e._v("，可以看作 “100 millicpu”。有些人说成是“一百毫 cpu”，其实说的是同样的事情。具有小数点（如 "),a("code",[e._v("0.1")]),e._v("）的请求由 API 转换为"),a("code",[e._v("100m")]),e._v("，精度不超过 "),a("code",[e._v("1m")]),e._v("。因此，可能会优先选择 "),a("code",[e._v("100m")]),e._v(" 的形式。")]),e._v(" "),a("p",[e._v("CPU 总是要用绝对数量，不可以使用相对数量；0.1 的 CPU 在单核、双核、48 核的机器中的意义是一样的。")]),e._v(" "),a("h2",{attrs:{id:"service-located-in-another-namespace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service-located-in-another-namespace"}},[e._v("#")]),e._v(" Service located in another namespace")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/37221483/service-located-in-another-namespace",target:"_blank",rel:"noopener noreferrer"}},[e._v("Service located in another namespace"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("servicename.namespace.svc.cluster.local")]),e._v(" "),a("p",[e._v("当你创建一个服务时， Kubernetes 会创建一个相应的 DNS 条目。")]),e._v(" "),a("p",[e._v("该条目的形式是 "),a("code",[e._v("<服务名称>.<名字空间名称>.svc.cluster.local")]),e._v("，这意味着如果容器只使用 "),a("code",[e._v("<服务名称>")]),e._v("，它将被解析到本地名字空间的服务。这对于跨多个名字空间（如开发、测试和生产） 使用相同的配置非常有用。如果你希望跨名字空间访问，则需要使用完全限定域名（FQDN）。")]),e._v(" "),a("p",[e._v("因此，所有的名字空间名称都必须是合法的 "),a("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/overview/working-with-objects/names/#dns-label-names",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 1123 DNS"),a("OutboundLink")],1),e._v(" 标签。")]),e._v(" "),a("p",[e._v("For Example:")]),e._v(" "),a("ul",[a("li",[e._v("In "),a("code",[e._v("dev-product")]),e._v(" namespace, there is a db pod and service "),a("code",[e._v("product-db")])]),e._v(" "),a("li",[e._v("In "),a("code",[e._v("dev-order")]),e._v(" namespace, if you want to call "),a("code",[e._v("product-db")]),e._v(" service which in "),a("code",[e._v("dev-product")]),e._v(" namespace. can use "),a("code",[e._v("product-db.dev-product.svc.cluster.local")])])]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# psql -h localhost -d database-name -U username -p port-number")]),e._v("\npsql -h product-db.dev-product.svc.cluster.local -d PRODUCT -U pguser -p "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("5432")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h2",{attrs:{id:"replace-a-pod-based-on-the-json-passed-into-stdin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#replace-a-pod-based-on-the-json-passed-into-stdin"}},[e._v("#")]),e._v(" Replace a pod based on the JSON passed into stdin")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/54032336/need-some-explaination-of-kubectl-stdin-and-pipe",target:"_blank",rel:"noopener noreferrer"}},[e._v("Need some explaination of kubectl stdin and pipe"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/kubernetes/cli-runtime/blob/v0.21.0/pkg/resource/builder.go#L246",target:"_blank",rel:"noopener noreferrer"}},[e._v("Short dash(-) here represents stdin. This is a kubectl specific implementation."),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("The important detail here is that the "),a("code",[e._v("kubectl ... -f")]),e._v(" option expects a filename. If you have a file named "),a("code",[e._v("x.yaml")]),e._v(", a more direct way to write what you've shown is just")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("kubectl replace -f x.yaml\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("Where you say "),a("code",[e._v("-f -")]),e._v(', that ostensibly means "a file named '),a("code",[e._v("-")]),e._v('", but kubectl (along with many other tools) actually interprets this to mean "the process\'s standard input". For instance, you could use this for a very lightweight templating system, like')]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'s/TAG/1.2.3-20190103/g'")]),e._v(" x.yaml "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" kubectl replace -f -\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("For "),a("code",[e._v("Un*x")]),e._v("tooling in general, "),a("a",{attrs:{href:"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap01.html#tag_17_04",target:"_blank",rel:"noopener noreferrer"}},[e._v("POSIX.1 states"),a("OutboundLink")],1),e._v(" that, for many commands,")]),e._v(" "),a("blockquote",[a("p",[e._v("...an operand naming a file can be specified as '-', which means to use the standard input instead of a named file....")])]),e._v(" "),a("h2",{attrs:{id:"livenessprobe-and-readinessprobe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#livenessprobe-and-readinessprobe"}},[e._v("#")]),e._v(" livenessProbe and readinessProbe")]),e._v(" "),a("h3",{attrs:{id:"spring-boot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot"}},[e._v("#")]),e._v(" Spring Boot")]),e._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/pages/86d8e0/#spring-boot-liveness-readiness"}},[e._v("Spring Boot 应用在 k8s 中的健康检查/liveness/readiness")])],1)]),e._v(" "),a("h3",{attrs:{id:"django"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django"}},[e._v("#")]),e._v(" Django")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/revsys/django-health-check",target:"_blank",rel:"noopener noreferrer"}},[e._v("django-health-check"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"kubernetes-pod-亲和性和反亲和性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-pod-亲和性和反亲和性"}},[e._v("#")]),e._v(" Kubernetes Pod 亲和性和反亲和性")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.opskumu.com/k8s-pod-affinity-antiaffinity.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes Pod 亲和性和反亲和性"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://gitee.com/dlwxin/example-kubernetes/tree/main/manifests/pod/anti-affinity/pod-affinity",target:"_blank",rel:"noopener noreferrer"}},[e._v("pod-affinity"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"kubernetes-in-docker-desktop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-in-docker-desktop"}},[e._v("#")]),e._v(" kubernetes in Docker Desktop")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.docker.com/blog/how-kubernetes-works-under-the-hood-with-docker-desktop/",target:"_blank",rel:"noopener noreferrer"}},[e._v("How Kubernetes works under the hood with Docker Desktop"),a("OutboundLink")],1)])]),e._v(" "),a("h3",{attrs:{id:"use-local-image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use-local-image"}},[e._v("#")]),e._v(" Use local image")]),e._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[e._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Pod\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("pod\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" httpd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("local\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" httpd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("local\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("imagePullPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Never\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br")])]),a("h2",{attrs:{id:"gateway-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gateway-api"}},[e._v("#")]),e._v(" Gateway API")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://gateway-api.sigs.k8s.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes Gateway API"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://gateway-api.sigs.k8s.io/concepts/versioning/#supported-versions",target:"_blank",rel:"noopener noreferrer"}},[e._v("Supported Versions"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://kubernetes.io/zh-cn/blog/2023/10/31/gateway-api-ga/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Gateway API v1.0：正式发布（GA）"),a("OutboundLink")],1)])]),e._v(" "),a("blockquote",[a("p",[e._v("与其他 Kubernetes API 不同，你无需升级到最新版本的 Kubernetes 即可获取最新版本的 Gateway API。只要运行的是 Kubernetes 最新的 5 个次要版本之一（1.24+）， 就可以使用最新版本的 Gateway API。")])]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/zh-cn/blog/2023/08/29/gateway-api-v0-8/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Gateway API v0.8.0：引入服务网格支持"),a("OutboundLink")],1)])]),e._v(" "),a("blockquote",[a("p",[e._v("Gateway API v0.8.0 不支持 Kubernetes 1.22 及更早版本\nGateway API 只承诺支持最新的 5 个 Kubernetes 版本。 因此，Gateway API 不再支持这些版本，不幸的是，在这些集群版本中无法安装 Gateway API v0.8.0， 因为包含 CEL 验证的 CRD 将被拒绝")])]),e._v(" "),a("h2",{attrs:{id:"tips"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tips"}},[e._v("#")]),e._v(" Tips")]),e._v(" "),a("ul",[a("li",[e._v("K8s 默认不允许容器监听物理机 1024 以下的端口")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/jBqrwmT9-NuZlEfAWKUHrQ",target:"_blank",rel:"noopener noreferrer"}},[e._v("K8s 如何查看 pod 崩溃前的日志及其原理"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);