(window.webpackJsonp=window.webpackJsonp||[]).push([[194],{657:function(s,e,a){"use strict";a.r(e);var t=a(18),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"links"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#links"}},[s._v("#")]),s._v(" Links")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/tasks/tools/#kubectl",target:"_blank",rel:"noopener noreferrer"}},[s._v("Install kubectl"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/reference/kubectl/cheatsheet/",target:"_blank",rel:"noopener noreferrer"}},[s._v("kubectl Cheat Sheet"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/dennyzhang/cheatsheet-kubernetes-A4",target:"_blank",rel:"noopener noreferrer"}},[s._v("cheatsheet-kubernetes-A4"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://m.yisu.com/zixun/459393.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes 的 CLI 是使用哪些技术实现的"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://erosb.github.io/post/json-patch-vs-merge-patch/",target:"_blank",rel:"noopener noreferrer"}},[s._v("JSON Patch and JSON Merge Patch"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"kubectl-autocomplete"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl-autocomplete"}},[s._v("#")]),s._v(" Kubectl autocomplete")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/reference/kubectl/cheatsheet/#kubectl-autocomplete",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubectl autocomplete"),a("OutboundLink")],1)])]),s._v(" "),a("h3",{attrs:{id:"bash"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bash"}},[s._v("#")]),s._v(" BASH")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setup autocomplete in bash into the current shell, bash-completion package should be installed first.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("kubectl completion "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# add autocomplete permanently to your bash shell.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source <(kubectl completion bash)"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.bashrc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("You can also use a shorthand alias for "),a("code",[s._v("kubectl")]),s._v(" that also works with completion:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("k")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kubectl\ncomplete -F __start_kubectl k\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("NB:")]),s._v(" "),a("blockquote",[a("p",[s._v("bash-completion package should be installed first")])]),s._v(" "),a("p",[s._v("That means you should "),a("a",{attrs:{href:"https://kubernetes.io/docs/tasks/tools/#kubectl",target:"_blank",rel:"noopener noreferrer"}},[s._v("install kubectl"),a("OutboundLink")],1),s._v(" first")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl --help "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" completion\n  completion    Output shell completion code "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the specified shell "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bash or "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("zsh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n$ complete "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -i start\ncomplete -o default -F __start_kubectl kubectl\ncomplete -F __start_kubectl k\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"zsh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zsh"}},[s._v("#")]),s._v(" ZSH")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("kubectl completion "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("zsh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setup autocomplete in zsh into the current shell")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[[ '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$commands")]),s._v('[kubectl] ]] && source <(kubectl completion zsh)"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.zshrc "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# add autocomplete permanently to your zsh shell")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"namespace-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#namespace-management"}},[s._v("#")]),s._v(" Namespace management")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List the current namespaces in a cluster")]),s._v("\nkubectl get namespace\nkubectl get ns\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Swithch namespace")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# You can permanently save the namespace for all subsequent kubectl commands in that context.")]),s._v("\nkubectl config set-context --current --namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("insert-namespace-name-here"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl config set-context --current --namespace=my-namespace")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl config set-context $(kubectl config current-context) --namespace=default")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# View current namespace used by current-context")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --minify=false: Remove all information not used by current-context from the output")]),s._v("\nkubectl config view --minify "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" namespace:\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a namespace")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Note: Avoid creating namespaces with the prefix 'kube-', since it is reserved for Kubernetes system namespaces.")]),s._v("\nkubectl create namespace my-namespace\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl apply -f -")]),s._v("\napiVersion: v1\nkind: Namespace\nmetadata:\n   name: my-namespace\nEOF")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete a namespace")]),s._v("\nkubectl delete namespace my-namespace\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl delete -f -")]),s._v("\napiVersion: v1\nkind: Namespace\nmetadata:\n   name: my-namespace\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("h2",{attrs:{id:"cluster-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cluster-management"}},[s._v("#")]),s._v(" Cluster management")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Check k8s version")]),s._v("\nkubectl version\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Client Version: version.Info{Major:"1", Minor:"18", GitVersion:"v1.18.3", GitCommit:"2e7996e3e2712684bc73f0dec0200d64eec7fe40", GitTreeState:"clean", BuildDate:"2020-05-20T12:52:00Z", GoVersion:"go1.14.3", Compiler:"gc", Platform:"darwin/amd64"}')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Server Version: version.Info{Major:"1", Minor:"18", GitVersion:"v1.18.3", GitCommit:"2e7996e3e2712684bc73f0dec0200d64eec7fe40", GitTreeState:"clean", BuildDate:"2020-05-27T23:11:46Z", GoVersion:"go1.13.9", Compiler:"gc", Platform:"linux/amd64"}')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 其中， "Client Version" 表示客户端（kubectl）版本信息， "Server Version" 表示服务器上运行的 Kubernetes 版本信息。')]),s._v("\nkubectl version --output"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Display addresses of the control plane and services with label kubernetes.io/cluster-service=true.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示整个集群的 Kubernetes master、KubeDNS、Metrics-server 等服务组件的 Endpoints")]),s._v("\nkubectl cluster-info\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Kubernetes control plane is running at https://127.0.0.1:6443")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CoreDNS is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Metrics-server is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/https:metrics-server:https/proxy")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 kubectl cluster-info dump --output-directory 分类存放集群信息，进一步调试和诊断集群问题。")]),s._v("\nkubectl cluster-info dump --output-directory"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/path/to/cluster-state\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改证书请求资源的状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Modify certificate resources.")]),s._v("\nkubectl certificate\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出证书签名请求")]),s._v("\nkubectl get csr\n\nkubectl api-resources "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" csr\ncertificatesigningrequests        csr          certificates.k8s.io/v1                 "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("        CertificateSigningRequest\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Approve a certificate signing request.")]),s._v("\nkubectl certificate approve\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Approve CSR 'csr-sqgzp'")]),s._v("\nkubectl certificate approve csr-sqgzp\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Deny a certificate signing request")]),s._v("\nkubectl certificate deny\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Deny CSR 'csr-sqgzp'")]),s._v("\nkubectl certificate deny csr-sqgzp\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示 node 或 pod 的 CPU、Memory 的使用量,需要提前安装并正确配置 Meric-server")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" node\nNAME           CPU"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cores"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   CPU%   MEMORY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   MEMORY%\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.177")]),s._v(".185.7   219m         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("%    1684Mi          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("%\n\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" pod\nNAME    CPU"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cores"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   MEMORY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nnginx   0m           3Mi\n\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" node --sort-by"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cpu\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" node --sort-by"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("memory\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Mark node as unschedulable.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将指定节点标记为不可被调度，将不会被 master 节点上的 kube-scheduler 分配新的 pod 运行任务。被标记的节点（除非发布任务时使用nodeName 强制指定标记的节点）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get nodes 查看到的 STATUS 为 Ready,SchedulingDisable")]),s._v("\nkubectl cordon\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Mark node "foo" as unschedulable')]),s._v("\nkubectl cordon foo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 标记指定节点为可以被 kube-scheduler 调度。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Mark node "foo" as schedulable')]),s._v("\nkubectl uncordon foo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Drain node in preparation for maintenance.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 排空准备维护的节点")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 给指定的节点标记为 SchedulingDisabled，防止被 kube-scheduler 分配新的 pod 运行任务。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 尝试把运行的 pod 迁移到其它 node 节点，如果无法迁移将删除 pod。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 使用 --ignore-daemonsets 参数删除由 DaemonSet 管理的 pod,使用 --delete-emptydir-data 参数删除存没有使用共享存储运行在数据存放在当前 node 节点的 pod。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. drain 后的 node 节点，可以使用 kubectl delete node NodeName,从 etcd 中彻底删除节点。使用 kubeadm reset 初始化该节点。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5. 也可以把 drain 后的 node 节点，使用 kubectl uncordon NodeName,重新标记为可以被调度")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Drain node "foo", even if there are pods not managed by a replication controller, replica set, job, daemon set or stateful set on it')]),s._v("\nkubectl drain foo --force\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use a grace period of 15 minutes")]),s._v("\nkubectl drain foo --grace-period"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("900")]),s._v("\n\nkubectl drain k8s-node2.lab.example.com --ignore-daemonsets --delete-emptydir-data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--force"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# taint（污点）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 kubeadm 初始化的集群，出于安全考虑 Pod 不会被调度到 Master 节点上，也就是说 Master 节点不参与工作负载。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这是因为当前的 master 节点被打上了 `node-role.kubernetes.io/master: NoSchedule` 的污点")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 taint 是从架构的角度， 不想一些 infra 的节点运行业务的 pod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 cordon 是从运维的角度，比如说某个节点要下线，或者需要维护")]),s._v("\n\n$ kubectl describe nodes k8s-master.lab.example.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" Taints\nTaints:      node-role.kubernetes.io/master: NoSchedule\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Usage:")]),s._v("\nkubectl taint NODE NAME "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("KEY_1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("VAL_1:TAINT_EFFECT_1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("KEY_N")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("VAL_N:TAINT_EFFECT_N "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# effect 取值")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# NoSchedule: 一定不能被调度")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# PreferNoSchedule:  尽量不要调度，实在没有地方调度的情况下，才考虑调度到当前节点")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# NoExecute: 不仅不会调度, 还会立即驱逐 Node 上已有的 Pod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -:去掉 taint，取值为空。")]),s._v("\n\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update node 'foo' with a taint with key 'dedicated' and value 'special-user' and effect 'NoSchedule'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If a taint with that key and effect already exists, its value is replaced as specified")]),s._v("\nkubectl taint nodes foo "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dedicated")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("special-user:NoSchedule\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove from node 'foo' the taint with key 'dedicated' and effect 'NoSchedule' if one exists")]),s._v("\nkubectl taint nodes foo dedicated:NoSchedule-\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove from node 'foo' all the taints with key 'dedicated'")]),s._v("\nkubectl taint nodes foo dedicated-\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Add a taint with key 'dedicated' on nodes having label mylabel=X")]),s._v("\nkubectl taint node -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("myLabel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("X  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dedicated")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("foo:PreferNoSchedule\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Add to node 'foo' a taint with key 'bar' and no value")]),s._v("\nkubectl taint nodes foo bar:NoSchedule\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 去掉 master 节点的污点，使 master 节点可以被调度")]),s._v("\n$ kubectl taint nodes k8s-master.lab.example.com node-role.kubernetes.io/master-\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 master 节点尽量不要被调度")]),s._v("\nkubectl taint nodes k8s-master.lab.example.com node-role.kubernetes.io/master:PreferNoSchedule\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# toleration（容忍）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 除了直接去除污点，还有一种办法可以让 pod 调度到 master 上")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以在 pod 的 yaml 配置文件中添加 tolerations 字段来使 pod 容忍节点的污点")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者在 pod 的 yaml 配置文件中添加 nodeName 字段来使 pod 容忍节点的污点")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例如，如果你想让你的 pod 可以被调度到 master 节点上，在 pod 的 spec 中添加如下设置即可：")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("toleration\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sleep'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3600'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" busybox\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("toleration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tolerations")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node-role.kubernetes.io/master'")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - key: '' # empty means match all taint keys")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Equal'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("single"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("simple"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("busybox\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodeName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("node1.lab.example.com\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" sleep\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3600'")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" busybox\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pods"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("simple"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("strong",[s._v("pod.spec.tolerations")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("字段")]),s._v(" "),a("th",[s._v("类型")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("effect")]),s._v(" "),a("td",[a("code",[s._v("<string>")])]),s._v(" "),a("td",[s._v("匹配的 taint 效果。空意味着匹配所有的污染效果。允许的值是 NoSchedule、PreferNoSchedule 和 NoExecute。")])]),s._v(" "),a("tr",[a("td",[s._v("key")]),s._v(" "),a("td",[a("code",[s._v("<string>")])]),s._v(" "),a("td",[s._v("key 是容忍适用所有适用的污点的 key。空表示匹配所有 taint keys。如果键为空，operator 操作符必须为 Exists;这种组合 意味着匹配所有 values 和所有 keys。")])]),s._v(" "),a("tr",[a("td",[s._v("value")]),s._v(" "),a("td",[a("code",[s._v("<string>")])]),s._v(" "),a("td",[s._v("值是容忍匹配的污染值。如果操作符为 Exists，则该值应该为空，否则只是一个常规字符串。")])]),s._v(" "),a("tr",[a("td",[s._v("operator")]),s._v(" "),a("td",[a("code",[s._v("<string>")])]),s._v(" "),a("td",[s._v("操作符表示键与值的关系。合法的操作符是 Exists 和 Equal。默认为 Equal。Exists 等价于值的通配符，因此 pod 可以容忍特 定类别的所有缺陷。")])]),s._v(" "),a("tr",[a("td",[s._v("tolerationSeconds")]),s._v(" "),a("td",[a("code",[s._v("<string>")])]),s._v(" "),a("td",[s._v("表示容忍污染的时间(NoExecute 必须有效，否则该字段将被忽略)。默认情况下，它没有设置，这意味着永远容忍污浊(而不是 驱逐)。0 和负值将被系统视为 0(立即驱逐)。")])])])]),s._v(" "),a("h2",{attrs:{id:"authorization-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authorization-management"}},[s._v("#")]),s._v(" Authorization management")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/zh/docs/reference/access-authn-authz/",target:"_blank",rel:"noopener noreferrer"}},[s._v("访问 API"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改、配置客户端登录凭证文件。每次执行 kubectl 命令可以使用--kubeconfig 指定登录凭证，或设置环境变量，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当多个登录凭证存在时，优先级排序： --kubeconfig > $KUBECONFIG > ${HOME}/.kube/config")]),s._v("\n\nkubectl get nodes --kubeconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=~")]),s._v("/.kube/config\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$KUBECONFIG")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=~")]),s._v("/.kube/config\nkubectl get nodes\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Display merged kubeconfig settings or a specified kubeconfig file")]),s._v("\nkubectl config view\nkubectl config view "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" namespace\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Display the current-context")]),s._v("\nkubectl config current-context\nmycluster-free/c7qubeaf0mevjf5urfdg\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Inspect authorization")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查当前用户的授权。 command: kubectl auth")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --as='': Username to impersonate for the operation")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查 tool-sa 这个service account 有没有权限创建 pod")]),s._v("\nkubectl auth can-i create pods --as tool-sa\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查当前用户是否可对某种资源执行操作")]),s._v("\n\nkubectl auth can-i create pods\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Check to see if I can create pods in any namespace")]),s._v("\nkubectl auth can-i create pods --all-namespaces\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Check to see if I can list deployments in my current namespace")]),s._v("\nkubectl auth can-i list deployments.apps\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Check to see if I can do everything in my current namespace ("*" means all)')]),s._v("\nkubectl auth can-i "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Check to see if I can get the job named "bar" in namespace "foo"')]),s._v("\nkubectl auth can-i list jobs.batch/bar -n foo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Check to see if I can read pod logs")]),s._v("\nkubectl auth can-i get pods --subresource"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("log\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Check to see if I can access the URL /logs/")]),s._v("\nkubectl auth can-i get /logs/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# List all allowed actions in namespace "foo"')]),s._v("\nkubectl auth can-i --list --namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("foo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Reconciles rules for RBAC role, role binding, cluster role, and cluster role binding objects.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用清单文件来创建或者更新 rbac.authorization.k8s.io/v1 API 对象。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 尚不存在的对象会被创建，如果对应的名字空间也不存在，必要的话也会被创建。 已经存在的角色会被更新，使之包含输入对象中所给的权限。如果指定了 --remove-extra-permissions，可以删除额外的权限。")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 已经存在的绑定也会被更新，使之包含输入对象中所给的主体。如果指定了 --remove-extra-permissions，则可以删除多余的主体。")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Reconcile RBAC resources from a file")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用 RBAC 对象的清单文件，保留角色中的额外权限和绑定中的其他主体")]),s._v("\nkubectl auth reconcile -f my-rbac-rules.yaml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试应用 RBAC 对象的清单文件，显示将要进行的更改：")]),s._v("\nkubectl auth reconcile -f my-rbac-rules.yaml --dry-run\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用 RBAC 对象的清单文件, 删除角色中的额外权限和绑定中的其他主体")]),s._v("\nkubectl auth reconcile -f my-rbac-rules.yaml --remove-extra-subjects --remove-extra-permissions\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"access-clusters-using-the-kubernetes-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#access-clusters-using-the-kubernetes-api"}},[s._v("#")]),s._v(" Access Clusters Using the Kubernetes API")]),s._v(" "),a("div",{attrs:{id:"access_endpoints"}}),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/892b0e469266",target:"_blank",rel:"noopener noreferrer"}},[s._v("k8s 之 service account"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://superuser.com/questions/1394619/how-to-get-the-admin-user-token-from-kubectl",target:"_blank",rel:"noopener noreferrer"}},[s._v("How to get the admin-user token from kubectl"),a("OutboundLink")],1)])]),s._v(" "),a("blockquote",[a("p",[s._v("有了 sa 后，我们就可以使用 sa 的 token 和 apiserver 交互了，由于所有通信都通过 TLS 进行，所以也得需要证书（ca.crt，这里的证书指的是 server 端的 ca 证书）或者允许不安全的连接("),a("code",[s._v("--insecure")]),s._v(")。\ntoken 和证书如何获取的？每个 sa 都会自动关联一个 secret，token 和证书就存在 secret 中。在 pod 内部他们被放在如下文件中(所有 pod 内部的 ca.crt 证书都一样，都是"),a("code",[s._v("/etc/kubernetes/pki/ca.crt")]),s._v(")")])]),s._v(" "),a("hr"),s._v(" "),a("blockquote",[a("p",[s._v("!!! IMPORTANT. With Kubernetes v1.24, non-expiring service account tokens are no longer auto-generated.\nK8s won’t generate Secrets any longer automatically for ServiceAccounts")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://itnext.io/big-change-in-k8s-1-24-about-serviceaccounts-and-their-secrets-4b909a4af4e0",target:"_blank",rel:"noopener noreferrer"}},[s._v("BIG change in K8s 1.24 about ServiceAccounts and their Secrets"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://eng.d2iq.com/blog/service-account-tokens-in-kubernetes-v1.24/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Service Account Tokens in Kubernetes v1.24"),a("OutboundLink")],1)])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 endpoints")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The URL of the Kubernetes API server.")]),s._v("\nkubectl config view --minify "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cut")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("- -d "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('":"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr")]),s._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),s._v("\nhttps://192.168.49.2:8443\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat ~/.kube/config")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://kubernetes.default.svc")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在k8s v1.24之前，每个 sa 默认都会绑定一个 secret(token)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据 sa 查看 secret 的名字")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SERVICE_ACCOUNT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("default\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAMESPACE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("default\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# SECRET=$(kubectl describe sa $SERVICE_ACCOUNT -n $NAMESPACE | grep -i tokens | awk '{print $2}')")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SECRET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get sa $SERVICE_ACCOUNT -n $NAMESPACE -o json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -Mr '.secrets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(".name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" select"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("contains"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"token"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从 secret 中查看 token")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TOKEN=$(kubectl describe secret $SECRET -n $NAMESPACE | grep -i 'token:' | awk '{print $2}')")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get secret $SECRET -n $NAMESPACE -o json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -Mr "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.data.token'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 -d"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("API_SERVER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl config view --minify "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cut")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("- -d "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('":"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr")]),s._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" --header "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Authorization: Bearer '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TOKEN")]),s._v('"')]),s._v(" --insecure -s "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$API_SERVER")]),s._v("/api\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("After v1.24")])]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/configuration/secret/#service-account-token-secrets",target:"_blank",rel:"noopener noreferrer"}},[s._v("Service account token Secrets"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAMESPACE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("default\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SERVICE_ACCOUNT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("build-robot\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SECRET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("build-robot-secret\n\nkubectl apply --namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NAMESPACE")]),s._v(" -f - "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\napiVersion: v1\nkind: Secret\nmetadata:\n  name: "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SECRET")]),s._v("\n  annotations:\n    kubernetes.io/service-account.name: "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SERVICE_ACCOUNT")]),s._v("\ntype: kubernetes.io/service-account-token\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从 secret 中查看 token")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TOKEN=$(kubectl describe secret $SECRET -n $NAMESPACE | grep -i 'token:' | awk '{print $2}')")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get secret $SECRET -n $NAMESPACE -o json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -Mr "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.data.token'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 -d"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# API_SERVER=$(kubectl config view --minify | grep server | cut -f 2- -d ":" | tr -d " ")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# API_SERVER=$(kubectl --kubeconfig=kubeconfig-$NAMESPACE config view --minify -o jsonpath='{.clusters[].cluster.server}')")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("API_SERVER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl config view --minify -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{.clusters[].cluster.server}'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Authorization: Bearer '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TOKEN")]),s._v('"')]),s._v(" --insecure -s "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$API_SERVER")]),s._v("/api\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("From - "),a("a",{attrs:{href:"https://kubernetes.io/docs/tasks/administer-cluster/access-cluster-api/#without-kubectl-proxy",target:"_blank",rel:"noopener noreferrer"}},[s._v("Offical Doc"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Check all possible clusters, as your .KUBECONFIG may have multiple contexts:")]),s._v("\nkubectl config view -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"Cluster name\\tServer\\n"}{range .clusters[*]}{.name}{"\\t"}{.cluster.server}{"\\n"}{end}\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Select name of cluster you want to interact with from above output:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"some_server_name"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Point to the API server referring the cluster name")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("APISERVER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl config view -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.clusters[?(@.name=='),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLUSTER_NAME")]),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(')].cluster.server}"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a secret to hold a token for the default service account")]),s._v("\nkubectl apply -f - "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\napiVersion: v1\nkind: Secret\nmetadata:\n  name: default-token\n  annotations:\n    kubernetes.io/service-account.name: default\ntype: kubernetes.io/service-account-token\nEOF")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Wait for the token controller to populate the secret with a token:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" kubectl describe secret default-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -E "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^token'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"waiting for token..."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&2")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get the token value")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get secret default-token -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{.data.token}'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 --decode"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Explore the API with TOKEN")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -X GET "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$APISERVER")]),s._v("/api --header "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Authorization: Bearer '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TOKEN")]),s._v('"')]),s._v(" --insecure\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("h3",{attrs:{id:"get-ca-certificate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-ca-certificate"}},[s._v("#")]),s._v(" Get CA Certificate")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://technekey.com/how-to-get-kubernetes-ca-certificate/",target:"_blank",rel:"noopener noreferrer"}},[s._v("How To Get Kubernetes CA Certificate"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Using Jsonpath")]),s._v("\nkubectl config view --raw -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{.clusters[0].cluster.certificate-authority-data}'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("base64  -d\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Replace [0] With [*] To Get For All The Clusters")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl config view --raw -o jsonpath='{.clusters[*].cluster.certificate-authority-data}' |base64  -d")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Using Go-Template, A Caveat: Dump The CA Certificate Of 1st Cluster If Kubeconfig Contains Multiple Clusters")]),s._v("\nkubectl config view --raw -o go-template"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{{index ((index (index .clusters 0) "cluster")) "certificate-authority-data"|base64decode}}\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Fetch It From Any Running POD Which Has A Service Account Mounted(If Needed Within The Pod)")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it busybox -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it busybox -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /var/run/secrets/kubernetes.io/serviceaccount/")]),s._v("\nca.crt     namespace  token\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat  /etc/kubernetes/pki/ca.crt")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"kubernetes-client-libraries"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-client-libraries"}},[s._v("#")]),s._v(" Kubernetes Client Libraries")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/reference/using-api/client-libraries/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Client Libraries"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"resource-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#resource-management"}},[s._v("#")]),s._v(" Resource management")]),s._v(" "),a("h3",{attrs:{id:"creating-objects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-objects"}},[s._v("#")]),s._v(" Creating objects")]),s._v(" "),a("p",[s._v("Kubernetes 配置可以用 YAML 或 JSON 定义。可以使用的文件扩展名有 "),a("code",[s._v(".yaml")]),s._v("、"),a("code",[s._v(".yml")]),s._v(" 和 "),a("code",[s._v(".json")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从文本文件或终端创建 kubenetes 资源。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a pod using the data in pod.json")]),s._v("\nkubectl create -f ./pod.json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a pod based on the JSON passed into stdin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" pod.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl create -f -\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Edit the data in docker-registry.yaml in JSON then create the resource using the edited data")]),s._v("\nkubectl create -f docker-registry.yaml --edit -o json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动单实例 nginx")]),s._v("\nkubectl create deployment nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n\nkubectl create deployment nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.20 --replicas"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\nkubectl create deployment nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.20 --dry-run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client -o yaml\n\nkubectl create configmap env-config --from-literal"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("log_level"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO\nkubectl create configmap env-config --from-literal"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("log_level"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO --from-literal"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("log_file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("logfile\nkubectl create configmap cm-hosts --from-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etce/hosts\n\nkubectl create secret\ndocker-registry  generic          tls\nkubectl create secret docker-registry --help\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If you don't already have a .dockercfg file, you can create a dockercfg secret directly by using:")]),s._v("\nkubectl create secret docker-registry my-secret --docker-server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("DOCKER_REGISTRY_SERVER --docker-username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("DOCKER_USER\n--docker-password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("DOCKER_PASSWORD --docker-email"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("DOCKER_EMAIL\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a new secret named my-secret from ~/.docker/config.json")]),s._v("\nkubectl create secret docker-registry my-secret --from-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".dockerconfigjson"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("path/to/.docker/config.json\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CERT_PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=~")]),s._v("/myapp/cert\nkubectl create secret generic my-secret --from-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CERT_PATH")]),s._v("/AlipayRootCert.crt --from-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CERT_PATH")]),s._v("/AlipayRootCert.crt --from-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CERT_PATH")]),s._v("/AlipayCertPublicKey.crt --from-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CERT_PATH")]),s._v("/AppCertPublicKey.crt -n default -o yaml --dry-run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过文件名或标准输入将配置应用于资源。必须指定资源名称。如果该资源尚不存在，则将创建它。要使用“应用”，请始终首先使用“apply”或“create --save-config”创建资源")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建资源")]),s._v("\nkubectl apply -f ./my-manifest.yaml\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用多个文件创建")]),s._v("\nkubectl apply -f ./my1.yaml -f ./my2.yaml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Apply the configuration in pod.json to a pod")]),s._v("\nkubectl apply -f ./pod.json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Apply resources from a directory containing kustomization.yaml - e.g. dir/kustomization.yaml")]),s._v("\nkubectl apply -k dir/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Apply the JSON passed into stdin to a pod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" pod.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl apply -f -\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从 URL 中创建资源")]),s._v("\nkubectl apply -f https://git.io/vPieo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Note: --prune is still in Alpha")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Apply the configuration in manifest.yaml that matches label app=nginx and delete all other resources that are not in the file and match label app=nginx")]),s._v("\nkubectl apply --prune -f manifest.yaml -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Apply the configuration in manifest.yaml and delete all the other config maps that are not in the file")]),s._v("\nkubectl apply --prune -f manifest.yaml --all --prune-whitelist"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("core/v1/ConfigMap\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a secret with several keys")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl apply -f -")]),s._v("\napiVersion: v1\nkind: Secret\nmetadata:\n  name: mysecret\ntype: Opaque\ndata:\n  password: "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s33msi4"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 -w0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n  username: "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jane"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 -w0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\nEOF")]),s._v("\n\nkubectl apply -f - "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: busybox\nspec:\n  containers:\n    - command: ['/bin/sh', '-c', 'tail -f /dev/null']\n      image: busybox\n      name: busybox\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create and run a particular image in a pod.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# !!!Note: 'kubectl run' command does not support run multiple containers.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start a nginx pod")]),s._v("\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$kubectl")]),s._v(" run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --limits"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cpu"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("500m,memory"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("300Mi\nFlag --limits has been deprecated, has no effect and will be removed "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.24")]),s._v(".\npod/nginx created\n\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.20 --expose\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# output:")]),s._v("\nservice/nginx created\npod/nginx created\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start a hazelcast pod and let the container expose port 5701")]),s._v("\nkubectl run hazelcast --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hazelcast/hazelcast --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5701")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Start a hazelcast pod and set environment variables "DNS_DOMAIN=cluster" and "POD_NAMESPACE=default" in the container')]),s._v("\nkubectl run hazelcast --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hazelcast/hazelcast --env"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DNS_DOMAIN=cluster"')]),s._v(" --env"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"POD_NAMESPACE=default"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Start a hazelcast pod and set labels "app=hazelcast" and "env=prod" in the container')]),s._v("\nkubectl run hazelcast --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hazelcast/hazelcast --labels"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app=hazelcast,env=prod"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Dry run; print the corresponding API objects without creating them")]),s._v("\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --dry-run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client\n\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --dry-run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client -o yaml\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --dry-run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client -o yaml "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nginx_pod.yaml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start a nginx pod, but overload the spec with a partial set of values parsed from JSON")]),s._v("\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --overrides"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{ "apiVersion": "v1", "spec": { ... } }\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start a busybox pod and keep it in the foreground, don't restart it if it exits")]),s._v("\nkubectl run -i -t busybox --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox:1.28 --restart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Never\nkubectl run -i -t busybox --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox:1.28.4 --restart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Never\n\nkubectl run busybox --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox:1.28 -it --attach --rm -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start the nginx pod using the default command, but use custom arguments (arg1 .. argN) for that command")]),s._v("\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx -- "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("argN"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start the nginx pod using a different command and custom arguments")]),s._v("\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --command -- "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("cmd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("argN"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nkubectl run nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.20 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --image-pull-policy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("IfNotPresent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("server")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("frontend,os"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ubuntu "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --annotations"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --annotations"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --env"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --env"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test1234 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --expose --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --privileged\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("########  Options ########")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定镜像的名字。")]),s._v("\n--image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定下载镜像的策略,可选策略 Always,Never,IfNotPresent,默认为 always")]),s._v("\n--image-pull-policy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定 pod 的标签")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Comma separated labels to apply to the pod. Will override previous values.")]),s._v("\n-l, --labels"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'k1=v1,k2=v2,...'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用于 pod 的注释，多个注释使用多个 --annotations 引导")]),s._v("\n--annotations"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 pod 中的环境变量，多个变量使用多个--env 引导")]),s._v("\n--env"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在容器中执行的命令")]),s._v("\n--command\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为 pod 创建 clusterIP Service")]),s._v("\n--expose\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定容器的暴露端口")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与 docker 在 Dockerfile expose 端口的作用类似。没有实际作用，只起提示信息的作用")]),s._v("\n--port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请等待 pod 启动运行，附加命令到 pod 中执行")]),s._v("\n--attach\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在执行完容器中 attach 命令后删除 pod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --rm=false: If true, delete the pod after it exits.  Only valid when attaching to the container, e.g. with '--attach' or with '-i/--stdin'.")]),s._v("\n--rm\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在资源 annotations 中记录当前的 kubectl 命令")]),s._v("\n--record\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以特权身份（超级用户）运行容器，默认为 false")]),s._v("\n--privileged\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定 pod 的重启策略，可选策略：Always,OnFailure,Never，默认为 Always")]),s._v("\n--restart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br")])]),a("h3",{attrs:{id:"viewing-finding-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#viewing-finding-resources"}},[s._v("#")]),s._v(" Viewing, finding resources")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印指定资源的信息，默认为当前名称空间。其中 all 为所有资源")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Display one or many resources.")]),s._v("\n\nkubectl get pod\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -v, --v=0: number for the log level verbosity")]),s._v("\nkubectl get pod --v"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\nkubectl get po\nkubectl get po nginx\nkubectl get po nginx -o yaml "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pod_nginx.yaml\nkubectl get node\nkubectl get no\nkubectl get deploy\nkubectl get svc\nkubectl get all\nkubectl get all -n kube-system\nkubectl get all -A\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List all pods in ps output format")]),s._v("\nkubectl get pods\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List all pods in ps output format with more information (such as node name)")]),s._v("\nkubectl get pods -o wide\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List pods name only")]),s._v("\nkubectl get pods -o name\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# When printing, show all labels as the last column (default hide labels column)")]),s._v("\nkubectl get pods --show-labels\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示 label key=region 的 pod")]),s._v("\nkubectl get pods -L region\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示 pod IP")]),s._v("\nkubectl get pods -o custom-columns"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("POD:metadata.name,IP:status.podIP --no-headers\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取特定节点上运行的 Pod 列表")]),s._v("\nkubectl get pods --field-selector spec.nodeName"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("node-name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List a single replication controller with specified NAME in ps output format")]),s._v("\nkubectl get replicationcontroller web\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# List deployments in JSON output format, in the "v1" version of the "apps" API group')]),s._v("\nkubectl get deployments.v1.apps -o json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List a single pod in JSON output format")]),s._v("\nkubectl get -o json pod web-pod-13je7\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 健康检查")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查 Pod 准备情况")]),s._v("\nkubectl get pods "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pod-name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{.status.conditions[?(@.type==\"Ready\")].status}'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# List a pod identified by type and name specified in "pod.yaml" in JSON output format')]),s._v("\nkubectl get -f pod.yaml -o json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List resources from a directory with kustomization.yaml - e.g. dir/kustomization.yaml")]),s._v("\nkubectl get -k dir/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Return only the phase value of the specified pod")]),s._v("\nkubectl get -o template pod/web-pod-13je7 --template"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(".status.phase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List resource information in custom columns")]),s._v("\nkubectl get pod test-pod -o custom-columns"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("CONTAINER:.spec.containers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(".name,IMAGE:.spec.containers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(".image\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List all replication controllers and services together in ps output format")]),s._v("\nkubectl get rc,services\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List one or more resources by their type and names")]),s._v("\nkubectl get rc/web service/frontend pods/web-pod-13je7\n\nkubectl get secret --namespace default my-secret -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.data.my-password}"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 --decode\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印指定资源的详细信息，包括 events、controllers、annotation 等。")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe a node")]),s._v("\nkubectl describe nodes kubernetes-node-emt8.c.myproject.internal\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe a pod")]),s._v("\nkubectl describe pods/nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Describe a pod identified by type and name in "pod.json"')]),s._v("\nkubectl describe -f pod.json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe all pods")]),s._v("\nkubectl describe pods\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe pods by label name=myLabel")]),s._v("\nkubectl describe po -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("myLabel\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe all pods managed by the 'frontend' replication controller")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (rc-created pods get the name of the rc as a prefix in the pod name)")]),s._v("\nkubectl describe pods frontend\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取资源的指定类型的文档信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List the fields for supported resources.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get the documentation of the resource and its fields")]),s._v("\nkubectl explain pods\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get the documentation of a specific field of a resource")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <type>.<fieldName>[.<fieldName>]")]),s._v("\nkubectl explain pods.spec.containers\nkubectl explain pods.metadata\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"updating-editing-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#updating-editing-resources"}},[s._v("#")]),s._v(" Updating, editing resources")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Configure application resources.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对现有应用程序的资源进行更改。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 key=value 的格式设置变量，多个变量用空格分割。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl set env 立刻触发重新部署")]),s._v("\n\nAvailable Commands:\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v("            Update environment variables on a pod template\n  image          Update the image of a pod template\n  resources      Update resource requests/limits on objects with pod templates\n  selector       Set the selector on a resource\n  serviceaccount Update the "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" account of a resource\n  subject        Update the user, group, or "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" account "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a role binding or cluster role binding\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Set a deployment's nginx container image to 'nginx:1.9.1', and its busybox container image to 'busybox'")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image deployment/nginx "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("busybox")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nginx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.9.1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update all deployments' and rc's nginx container's image to 'nginx:1.9.1'")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image deployments,rc "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nginx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.9.1 --all\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update image of all containers of daemonset abc to 'nginx:1.9.1'")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image daemonset abc *"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.9.1\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image daemonset abc *"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.9.1 --record\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Flag --record can record `change cause`")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Flag --record has been deprecated  --record will be removed in the future")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以将 change cause 写在 annotation中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# kubectl annotate daemonset/abc kubernetes.io/change-cause="XXX"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl rollout history daemonset/abc 查看部署版本编号 REVISION 及版本变更缘由 CHANGE-CAUSE")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print result (in yaml format) of updating nginx container image from local file, without hitting the server")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image -f path/to/file.yaml "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nginx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.9.1 --local -o yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update deployment 'registry' with a new environment variable")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" deployment/registry "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("STORAGE_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/local\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" deployment registry "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("k1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("K2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v2\n\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" registry-907i85gy98-io98jt -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printenv")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" registry-907i85gy98-io98jt -- "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$k1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List the environment variables defined on a deployments 'sample-build'")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" deployment/sample-build --list\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("strong",[s._v("Kubectl set 子命令可应用的资源")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("resources")]),s._v(" "),a("th",[s._v("kubectl set env")]),s._v(" "),a("th",[s._v("kubectl set image")]),s._v(" "),a("th",[s._v("vkubectl set resource")]),s._v(" "),a("th",[s._v("kubectl set serviceaccount")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("pod (po)")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("replicationcontroller (rc)")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")])]),s._v(" "),a("tr",[a("td",[s._v("replicaset (rs)")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")])]),s._v(" "),a("tr",[a("td",[s._v("deployment (deploy)")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")])]),s._v(" "),a("tr",[a("td",[s._v("daemonset (ds)")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")])]),s._v(" "),a("tr",[a("td",[s._v("job")]),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")])]),s._v(" "),a("tr",[a("td",[s._v("statefulset")]),s._v(" "),a("td"),s._v(" "),a("td"),s._v(" "),a("td",[s._v("Y")]),s._v(" "),a("td",[s._v("Y")])])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl rollout")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 支持的资源：deployments、daemonsets、statefulsets")]),s._v("\n\nAvailable Commands:\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("     View rollout "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n  pause       Mark the provided resource as paused\n  restart     Restart a resource\n  resume      Resume a paused resource\n  status      Show the status of the rollout\n  undo        Undo a previous rollout\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# history 查看部署版本编号 REVISION 及版本变更缘由 CHANGE-CAUSE")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# history 子命令回显的 CHANGE-CAUSE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CHANGE-CAUSE 默认为空。从 Deployment 的 kubernetes.io/change-cause 注解复制过来的。 复制动作发生在修订版本创建时。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 你可以通过 以下方式设置 CHANGE-CAUSE 消息：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - 使用 kubectl annotate deployment.v1.apps/nginx-deployment kubernetes.io/change-cause="XXX" 为 Deployment 添加注解。')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - 使用 kubectl 变更 deployment 时，添加 --record 参数。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - 手动编辑资源的 manifest（清单）。")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# View the rollout history of a deployment")]),s._v("\nkubectl rollout "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" deployment/abc\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# View the details of daemonset revision 3")]),s._v("\nkubectl rollout "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" daemonset/abc --revision"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pause 暂停当前的重新部署或回滚操作")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Mark the nginx deployment as paused")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Any current state of the deployment will continue its function; new updates")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# to the deployment will not have an effect as long as the deployment is paused")]),s._v("\nkubectl rollout pause deployment/nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# resume 恢复暂停的部署或回滚操作")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Resume an already paused deployment")]),s._v("\nkubectl rollout resume deployment/nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart 重新执行回滚操")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Restart a deployment")]),s._v("\nkubectl rollout restart deployment/nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Restart a daemon set")]),s._v("\nkubectl rollout restart daemonset/abc\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# status 占用一个终端，持续监控回滚状态直到回滚完成。--revision=N 指定版本号")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Watch the rollout status of a deployment")]),s._v("\nkubectl rollout status deployment/nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# undo 回滚部署，默认为上一个版本。--to-revision=N 指定版本")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Roll back to the previous deployment")]),s._v("\nkubectl rollout undo deployment/abc\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Roll back to daemonset revision 3")]),s._v("\nkubectl rollout undo daemonset/abc --to-revision"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Roll back to the previous deployment with dry-run")]),s._v("\nkubectl rollout undo --dry-run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("server deployment/abc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Edit a resource from the default editor.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# edit 命令使您可以直接编辑可通过命令行工具检索的任何 API 资源。 它将打开由 KUBE_EDITOR 或 EDITOR 环境变量定义的编辑器，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 或者对于 Linux 退回到"vi"，对于 Windows 退回到"notepad"。 您可以编辑多个对象，尽管一次只能应用一个更改')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Edit the service named 'docker-registry'")]),s._v("\nkubectl edit svc/docker-registry\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use an alternative editor")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("KUBE_EDITOR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nano"')]),s._v(" kubectl edit svc/docker-registry\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Edit the job 'myjob' in JSON using the v1 API format")]),s._v("\nkubectl edit job.v1.batch/myjob -o json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Edit the deployment 'mydeployment' in YAML and save the modified config in its annotation")]),s._v("\nkubectl edit deployment/mydeployment -o yaml --save-config\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过文本文件或标准命令行特换已经存在的资源")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Replace a pod using the data in pod.json")]),s._v("\nkubectl replace -f ./pod.json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Replace a pod based on the JSON passed into stdin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" pod.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl replace -f -\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update a single-container pod's image version (tag) to v4")]),s._v("\nkubectl get pod mypod -o yaml "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/\\(image: myimage\\):.*$/\\1:v4/'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl replace -f -\n\nkubectl get cm configmap-log4j2-01 -o yaml "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'s/<Root level=\\"info\\"/<Root level=\\"trace\\"/\'')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl replace -f -\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Force replace, delete and then re-create the resource")]),s._v("\nkubectl replace --force -f ./pod.json\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"patching-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patching-resources"}},[s._v("#")]),s._v(" Patching resources")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/55744582/how-to-update-secret-with-kubectl-patch-type-json",target:"_blank",rel:"noopener noreferrer"}},[s._v("How to update secret with \"kubectl patch --type='json'\""),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://erosb.github.io/post/json-patch-vs-merge-patch/",target:"_blank",rel:"noopener noreferrer"}},[s._v("JSON Patch and JSON Merge Patch"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc6902",target:"_blank",rel:"noopener noreferrer"}},[s._v("RFC 6902 (JSON Patch)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc7386",target:"_blank",rel:"noopener noreferrer"}},[s._v("RFC 7396 (JSON Merge Patch)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch/#use-a-json-merge-patch-to-update-a-deployment",target:"_blank",rel:"noopener noreferrer"}},[s._v("Use a JSON merge patch to update a Deployment"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 JSON 补丁更新资源的字段。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update fields of a resource using strategic merge patch, a JSON merge patch, or a JSON patch.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# JSON and YAML formats are accepted.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Partially update a node using a strategic merge patch, specifying the patch as JSON")]),s._v("\nkubectl patch node k8s-node-1 -p "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"spec":{"unschedulable":true}}\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Partially update a node using a strategic merge patch, specifying the patch as YAML")]),s._v("\nkubectl patch node k8s-node-1 -p "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("$'spec:"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v(" unschedulable: true'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Partially update a node identified by the type and name specified in "node.json" using strategic merge patch')]),s._v("\nkubectl patch -f node.json -p "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"spec":{"unschedulable":true}}\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update a container's image; spec.containers[*].name is required because it")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s a merge key\nkubectl patch pod valid-pod -p '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"spec"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"containers"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes-serve-hostname"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"image"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"new image"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n\n# Update a container'")]),s._v("s image using a JSON patch with positional arrays\nkubectl patch pod valid-pod --type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json'")]),s._v(" -p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'[{"op": "replace", "path": "/spec/containers/0/image", "value":"newimage"}]\'')]),s._v("\n\nkubectl patch deployment deployment-demo --type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json'")]),s._v(" -p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'[{"op": "replace", "path": "/spec/replicas", "value":8}]\'')]),s._v("\nkubectl patch deployment deployment-demo --type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json'")]),s._v(" -p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'[{"op": "replace", "path": "/spec/template/spec/containers/0/image", "value":"http"}]\'')]),s._v("\nkubectl patch secret "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" --type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json'")]),s._v(" -p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'[{"op" : "replace" ,"path" : "/data/username" ,"value" : "dGVzdHVzZXIy"}]\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h3",{attrs:{id:"scaling-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scaling-resources"}},[s._v("#")]),s._v(" Scaling resources")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对 指 定 的 deployments 、 replicasets 、 replicationcontrollers 、 statefulsets 副 本 数 量 进 行 缩 放 。 如 果 指 定 了 --current-replicas 或")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --resource-version 则会在尝试缩放之前对其进行验证，并保证在将缩放发送到服务器时前提条件为 true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Scale a replica set named 'foo' to 3")]),s._v("\nkubectl scale --replicas"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" rs/foo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Scale a resource identified by type and name specified in "foo.yaml" to 3')]),s._v("\nkubectl scale --replicas"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" -f foo.yaml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If the deployment named mysql's current size is 2, scale mysql to 3")]),s._v("\nkubectl scale --current-replicas"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" --replicas"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" deployment/mysql\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Scale multiple replication controllers")]),s._v("\nkubectl scale --replicas"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" rc/foo rc/bar rc/baz\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Scale stateful set named 'web' to 3")]),s._v("\nkubectl scale --replicas"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" statefulset/web\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 metric-server 对指定的 deployments、replicasets、replicationcontrollers、statefulsets 的 cpu-percent 进行监控，自动缩放 pod 副本的数量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Auto scale a deployment "foo", with the number of pods between 2 and 10, no target CPU utilization specified')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# so a default autoscaling policy will be used")]),s._v("\nkubectl autoscale deployment foo --min"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" --max"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Auto scale a replication controller "foo", with the number of pods between 1 and 5, target CPU utilization at 80%')]),s._v("\nkubectl autoscale rc foo --max"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" --cpu-percent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"deleting-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deleting-resources"}},[s._v("#")]),s._v(" Deleting resources")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete resources by file names, stdin, resources and names, or by resources and label selector.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 按照资源名称或标签选择器检索使用文本或命令行的方式删除资源")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定优雅终止资源时等待的时间，单位为秒。pod 优雅终止时间默认为 30 秒。设置为 0 配合--force 强制立刻删除资。")]),s._v("\n--grace-period"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("N\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 立刻删除资源等同于--grace-period=1")]),s._v("\n--now\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete a pod using the type and name specified in pod.json")]),s._v("\nkubectl delete -f ./pod.json\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete resources from a directory containing kustomization.yaml - e.g. dir/kustomization.yaml")]),s._v("\nkubectl delete -k "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete a pod based on the type and name in the JSON passed into stdin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" pod.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl delete -f -\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Delete pods and services with same names "baz" and "foo"')]),s._v("\nkubectl delete pod,service baz foo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete pods and services with label name=myLabel")]),s._v("\nkubectl delete pods,services -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("myLabel\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete a pod with minimal delay")]),s._v("\nkubectl delete pod foo --now\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Force delete a pod on a dead node")]),s._v("\nkubectl delete pod foo --force\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete all pods")]),s._v("\nkubectl delete pods --all\n\nkubectl delete pod --all --now\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("h3",{attrs:{id:"debugging-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#debugging-resources"}},[s._v("#")]),s._v(" Debugging resources")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建调试会话以对工作负载和节点进行故障排除，默认资源类型为 pod。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调试”采取的操作因指定的资源而异。支持的行动包括：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# *工作负载：创建现有 pod 的副本，并更改某些属性，例如将图像标记更改为新版本。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# *工作负载：向已经运行的 pod 添加临时容器，例如，在不重新启动 pod 的情况下添加调试实用程序。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# *节点：创建一个新的 pod，该 pod 在节点的主机名称空间中运行，并且可以访问节点的文件系统。")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create an interactive debugging session in pod mypod and immediately attach to it.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (requires the EphemeralContainers feature to be enabled in the cluster)")]),s._v("\nkubectl debug mypod -it --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a debug container named debugger using a custom automated debugging image.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (requires the EphemeralContainers feature to be enabled in the cluster)")]),s._v("\nkubectl debug --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("myproj/debug-tools -c debugger mypod\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a copy of mypod adding a debug container and attach to it")]),s._v("\nkubectl debug mypod -it --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox --copy-to"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-debugger\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a copy of mypod changing the command of mycontainer")]),s._v("\nkubectl debug mypod -it --copy-to"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-debugger --container"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mycontainer -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a copy of mypod changing all container images to busybox")]),s._v("\nkubectl debug mypod --copy-to"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-debugger --set-image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a copy of mypod adding a debug container and changing container images")]),s._v("\nkubectl debug mypod -it --copy-to"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-debugger --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("debian --set-image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("app:debug,sidecar"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sidecar:debug\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create an interactive debugging session on a node and immediately attach to it.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The container will run in the host namespaces and the host's filesystem will be mounted at /host")]),s._v("\nkubectl debug node/mynode -it --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 在 node1 节点上使用"hostIPC: true"，"hostNetwork: true"，"hostPID: true"，"restartPolicy: Never"启用 debugger 容器，并以 rw 挂载 节点的"/"文件系统到 centos 容器中的/host 文件夹。')]),s._v("\nkubectl debug node/mynode -it --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("centos\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 转发 kube-apiserver 到本地的指定地址和端口默认为 127.0.0.1:8001，通过 curl 获取集群资源信息。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --address='' 指定转发到本机的 ip 地址，默认为 127.0.0.1 -p, --port= 指定转发到本机的端口默认为 8001, 0 为随机端口。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --accept-hosts='' 使用正则表达式指定允许访问转发的主机，默认为 localhost，'^*$'为放行所有主机。")]),s._v("\n\nkubectl proxy "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" --address"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 --accept-hosts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^*$'")]),s._v("\nkubectl proxy "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v("\nkubectl proxy\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# To proxy all of the Kubernetes API and nothing else")]),s._v("\nkubectl proxy --api-prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# To proxy only part of the Kubernetes API and also some static files")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# You can get pods info with 'curl localhost:8001/api/v1/pods'")]),s._v("\nkubectl proxy --www"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/my/files --www-prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/static/ --api-prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/api/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# To proxy the entire Kubernetes API at a different root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# You can get pods info with 'curl localhost:8001/custom/api/v1/pods'")]),s._v("\nkubectl proxy --api-prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/custom/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Run a proxy to the Kubernetes API server on port 8011, serving static content from ./local/www/")]),s._v("\nkubectl proxy --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8011")]),s._v(" --www"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./local/www/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Run a proxy to the Kubernetes API server on an arbitrary local port")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The chosen port for the server will be output to stdout")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The port on which to run the proxy. Set to 0 to pick a random port.")]),s._v("\nkubectl proxy --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Run a proxy to the Kubernetes API server, changing the API prefix to k8s-api")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This makes e.g. the pods API available at localhost:8001/k8s-api/v1/pods/")]),s._v("\nkubectl proxy --api-prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/k8s-api\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h3",{attrs:{id:"labeling-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#labeling-resources"}},[s._v("#")]),s._v(" Labeling resources")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以 key=value 的格式，设置或更新资源的标签")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 标签 key 和 value 必须以字母或数字开头，可以包含字母、数字、“-”、“.”和“_”，每个字符长度不超过 63 个字符。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# key 可以以使用类似于 DNS 子域前缀和单个“/”开头，如 example.com/my-app.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认不允许修改现存标签的 value，使用--overwrite 覆盖现有标签的 value.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用--resource-version 设置资源的某个版本的标签，否则为当前版本。")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' with the label 'unhealthy' and the value 'true'")]),s._v("\nkubectl label pods foo "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("unhealthy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' with the label 'status' and the value 'unhealthy', overwriting any existing value")]),s._v("\nkubectl label --overwrite pods foo "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unhealthy\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update all pods in the namespace")]),s._v("\nkubectl label pods --all "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unhealthy\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Update a pod identified by the type and name in "pod.json"')]),s._v("\nkubectl label -f pod.json "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unhealthy\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' only if the resource is unchanged from version 1")]),s._v("\nkubectl label pods foo "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unhealthy --resource-version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' by removing a label named 'bar' if it exists")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Does not require the --overwrite flag")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除 label")]),s._v("\nkubectl label pods foo bar-\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h3",{attrs:{id:"annotating-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#annotating-resources"}},[s._v("#")]),s._v(" Annotating resources")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新或设置一个或多个资源的注释")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 所有 Kubernetes 对象都支持将附加数据作为注释与对象一起存储。注释是权重大于标签的键/值对，并且包含任意字符串值，如结构化 JSON。可以")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以使用注释来所有 Kubernetes 对象都支持将附加数据作为注释与对象一起存储。注释是可以大于标签的键/值对，并且包含任意字符串值，可以")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用注释实现 Kubernetes 处于 beta 阶段的功能扩展。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 默认不允许修改现存注释的 value，使用--overwrite 覆盖现有注释的 value.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 使用--resource-version 设置资源的某个版本的注释，否则为当前版本")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' with the annotation 'description' and the value 'my frontend'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If the same annotation is set multiple times, only the last value will be applied")]),s._v("\nkubectl annotate pods foo "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my frontend'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Update a pod identified by type and name in "pod.json"')]),s._v("\nkubectl annotate -f pod.json "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my frontend'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' with the annotation 'description' and the value 'my frontend running nginx', overwriting any existing value")]),s._v("\nkubectl annotate --overwrite pods foo "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my frontend running nginx'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update all pods in the namespace")]),s._v("\nkubectl annotate pods --all "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my frontend running nginx'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' only if the resource is unchanged from version 1")]),s._v("\nkubectl annotate pods foo "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my frontend running nginx'")]),s._v(" --resource-version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update pod 'foo' by removing an annotation named 'description' if it exists")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Does not require the --overwrite flag")]),s._v("\nkubectl annotate pods foo description-\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h3",{attrs:{id:"operational-commands"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#operational-commands"}},[s._v("#")]),s._v(" Operational commands")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在指定容器中执行命")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -c, --container='' 指定 pod 中容器的名字，默认为 pod 中的第一个容器。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -it: 配合 -- bash | sh 进入容器内部以交互式方式执行命令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get output from running the 'date' command from pod mypod, using the first container by default")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mypod -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mypod -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printenv")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get output from running the 'date' command in ruby-container from pod mypod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# check container name via 'kubectl describe' command")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mypod -c ruby-container -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Switch to raw terminal mode; sends stdin to 'bash' in ruby-container from pod mypod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# and sends stdout/stderr from 'bash' back to the client")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mypod -c ruby-container -i -t -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" -il\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List contents of /usr from the first container of pod mypod and sort by modification time")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If the command you want to execute in the pod has any flags in common (e.g. -i),")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# you must use two dashes (--) to separate your command's flags/arguments")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Also note, do not surround your command and its flags/arguments with quotes")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# unless that is how you would execute it normally (i.e., do ls -t /usr, not "ls -t /usr")')]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mypod -i -t -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -t /usr\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get output from running 'date' command from the first pod of the deployment mydeployment, using the first container by default")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" deploy/mydeployment -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get output from running 'date' command from the first pod of the service myservice, using the first container by default")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" svc/myservice -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在本地文件系统和容器内部拷贝文件。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 依赖容器内 tar 命令，如果容器内没有 tar 命令，kubectl cp 将会失败 ###")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy /tmp/foo local file to /tmp/bar in a remote pod in namespace <some-namespace>")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" cf - /tmp/foo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -i -n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-pod"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf - -C /tmp/bar\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy /tmp/foo from a remote pod to /tmp/bar locally")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-pod"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" cf - /tmp/foo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf - -C /tmp/bar\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy /tmp/foo_dir local directory to /tmp/bar_dir in a remote pod in the default namespace")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /tmp/foo_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-pod"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":/tmp/bar_dir\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy /tmp/foo local file to /tmp/bar in a remote pod in a specific container")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /tmp/foo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-pod"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":/tmp/bar -c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("specific-container"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy /tmp/foo local file to /tmp/bar in a remote pod in namespace <some-namespace>")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /tmp/foo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-pod"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":/tmp/bar\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy /tmp/foo from a remote pod to /tmp/bar locally")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("some-pod"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":/tmp/foo /tmp/bar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印 pod 中指定 container 的日志信息，默认为 pod 中第一个 container 的日志。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the logs for a container in a pod or specified resource. If the pod has only one container, the container name is optional.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印指定 pod 中所有容器的日志。")]),s._v("\n--all-containers\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印指定容器的日志，默认为 pod 中第一个容器。")]),s._v("\n-c, --container"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印指定标签的容器的日志。")]),s._v("\n-l, --selector"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以流式方式滚动打印日志。")]),s._v("\n-f, --follow\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅打印最后 N 行日志")]),s._v("\n--tail"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("N\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Return snapshot logs from pod nginx with only one container")]),s._v("\nkubectl logs nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Return snapshot logs from pod nginx with multi containers")]),s._v("\nkubectl logs nginx --all-containers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Return snapshot logs from all containers in pods defined by label app=nginx")]),s._v("\nkubectl logs -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --all-containers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Return snapshot of previous terminated ruby container logs from pod web-1")]),s._v("\nkubectl logs -p -c ruby web-1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Begin streaming the logs of the ruby container in pod web-1")]),s._v("\nkubectl logs -f -c ruby web-1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Begin streaming the logs from all containers in pods defined by label app=nginx")]),s._v("\nkubectl logs -f -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --all-containers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Display only the most recent 20 lines of output in pod nginx")]),s._v("\nkubectl logs --tail"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Show all logs from pod nginx written in the last hour")]),s._v("\nkubectl logs --since"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1h nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Show logs from a kubelet with an expired serving certificate")]),s._v("\nkubectl logs --insecure-skip-tls-verify-backend nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Return snapshot logs from first container of a job named hello")]),s._v("\nkubectl logs job/hello\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Return snapshot logs from container nginx-1 of a deployment named nginx")]),s._v("\nkubectl logs deployment/nginx -c nginx-1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ----previous If true, print the logs for the previous instance of the container in a pod if it exists.")]),s._v("\nkubectl logs pod-name --previous\nkubectl logs pod-name --previous -c container-name\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("h3",{attrs:{id:"build-and-deploy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-and-deploy"}},[s._v("#")]),s._v(" Build and deploy")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将本地的一个或多个端口转发到 pod localport:Podport，会持续占用一个终端。 支持的资源:pod、deploy、service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Usage:")]),s._v("\nkubectl port-forward TYPE/NAME "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LOCAL_PORT:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("REMOTE_PORT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LOCAL_PORT_N:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("REMOTE_PORT_N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Listen on ports 5000 and 6000 locally, forwarding data to/from ports 5000 and 6000 in the pod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将本地的 5000 和 6000 端口转发到 pod 的 5000 和 6000 端口")]),s._v("\nkubectl port-forward pod/mypod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Listen on ports 5000 and 6000 locally, forwarding data to/from ports 5000 and 6000 in a pod selected by the deployment")]),s._v("\nkubectl port-forward deployment/mydeployment "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Listen on port 8443 locally, forwarding to the targetPort of the service\'s port named "https" in a pod selected by the service')]),s._v("\nkubectl port-forward service/myservice "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v(":https\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Listen on port 8888 locally, forwarding to 5000 in the pod")]),s._v("\nkubectl port-forward pod/mypod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":5000\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Listen on port 8888 on all addresses, forwarding to 5000 in the pod")]),s._v("\nkubectl port-forward --address "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 pod/mypod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":5000\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Listen on port 8888 on localhost and selected IP, forwarding to 5000 in the pod")]),s._v("\nkubectl port-forward --address localhost,10.19.21.23 pod/mypod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":5000\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Listen on a random port locally, forwarding to 5000 in the pod")]),s._v("\nkubectl port-forward pod/mypod :5000\n\nkubectl port-forward --address "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 svc/nexus3 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":80 -n tools\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# to perform `kubectl port-forward` in background, can append the command `&`")]),s._v("\nkubectl port-forward --address "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 svc/nexus3 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":80 -n tools "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tunnel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" port-forward "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" nexus3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $2}'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tunnel")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tunnel")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给已经存在的 pod (po), service (svc), replicationcontroller (rc), deployment (deploy), replicaset (rs)资源创建或关联 service")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Expose a resource as a new Kubernetes service.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a service for a replicated nginx, which serves on port 80 and connects to the containers on port 8000")]),s._v("\nkubectl expose rc nginx --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --target-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Create a service for a replication controller identified by type and name specified in "nginx-controller.yaml", which serves on port 80 and connects to the containers on port 8000')]),s._v("\nkubectl expose -f nginx-controller.yaml --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --target-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Create a service for a pod valid-pod, which serves on port 444 with the name "frontend"')]),s._v("\nkubectl expose pod valid-pod --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("444")]),s._v(" --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("frontend\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Create a second service based on the above service, exposing the container port 8443 as port 443 with the name "nginx-https"')]),s._v("\nkubectl expose "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" --target-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v(" --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx-https\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a service for a replicated streaming application on port 4100 balancing UDP traffic and named 'video-stream'.")]),s._v("\nkubectl expose rc streamer --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4100")]),s._v(" --protocol"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("UDP --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("video-stream\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a service for a replicated nginx using replica set, which serves on port 80 and connects to the containers on port 8000")]),s._v("\nkubectl expose rs nginx --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --target-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a service for an nginx deployment, which serves on port 80 and connects to the containers on port 8000")]),s._v("\nkubectl expose deployment nginx --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --target-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"other-commands"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#other-commands"}},[s._v("#")]),s._v(" Other Commands")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 以"group/version"的格式，打印当前服务端支持的 api 版本。')]),s._v("\nkubectl api-versions\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出集群支持 API 资源，NAME 资源名称、SHORTNAMES 简名、APIVERSION 版本号、NAMESPACED 是否为名称空间资源以及类型 Kind")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the supported API resources on the server.")]),s._v("\nkubectl api-resources\n\nkubectl api-resources"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" -4\nNAME                              SHORTNAMES   APIVERSION                             NAMESPACED   KIND\nbindings                                       v1                                     "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("         Binding\ncomponentstatuses                 cs           v1                                     "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("        ComponentStatus\nconfigmaps                        cm           v1                                     "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("         ConfigMap\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the supported API resources with more information")]),s._v("\nkubectl api-resources -o wide\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the supported API resources sorted by a column")]),s._v("\nkubectl api-resources --sort-by"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("name\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 大多数 kubernetes 资源（例如 Pod、Service、副本控制器等）都位于某些名字空间中。 但是名字空间资源本身并不在名字空间中。而是底层资源，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例如节点和持久化卷不属于任何名字空间。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the supported namespaced resources")]),s._v("\nkubectl api-resources --namespaced"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the supported non-namespaced resources")]),s._v("\nkubectl api-resources --namespaced"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the supported API resources with a specific APIGroup")]),s._v("\nkubectl api-resources --api-group"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("extensions\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);