(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{561:function(s,a,e){"use strict";e.r(a);var n=e(18),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"generate-a-key-using-ssh-keygen"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#generate-a-key-using-ssh-keygen"}},[s._v("#")]),s._v(" Generate a key using "),e("code",[s._v("ssh-keygen")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("ssh-keygen -t rsa -b "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("And you can see")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l ~/.ssh/\ntotal "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n-rwx------ "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2602")]),s._v(" Jan  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":41 id_rsa*\n-rwx------ "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("572")]),s._v(" Jan  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":41 id_rsa.pub*\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"copy-id-rsa-pub-to-destination-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#copy-id-rsa-pub-to-destination-server"}},[s._v("#")]),s._v(" Copy "),e("code",[s._v("id_rsa.pub")]),s._v(" to destination server")]),s._v(" "),e("p",[s._v("Once the the public key is generated, copy the "),e("code",[s._v(".pub")]),s._v(" file as "),e("strong",[s._v("authorized_keys")]),s._v(" under "),e("code",[s._v(".ssh")]),s._v(" directory under user home for the user in destination server. Once done, try to do "),e("code",[s._v("ssh")]),s._v(" which will connect without password.")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" .ssh/id_rsa.pub "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@server2 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cat >> .ssh/authorized_keys'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"test-scp-and-ssh-commands"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#test-scp-and-ssh-commands"}},[s._v("#")]),s._v(" Test scp and ssh commands")]),s._v(" "),e("p",[s._v("if it does not work, can refer to "),e("RouterLink",{attrs:{to:"/pages/fa4788/#permissions_are_too_open"}},[s._v('ssh-add error: "Permissions are too open"')])],1),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@server2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" README.md root@server2:~/workspace\nREADME.md                                          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1437")]),s._v("    "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v(".7KB/s   00:00\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"run-command-using-ssh"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#run-command-using-ssh"}},[s._v("#")]),s._v(" Run Command Using SSH")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.cyberciti.biz/faq/unix-linux-execute-command-using-ssh/",target:"_blank",rel:"noopener noreferrer"}},[s._v("How To Run / Execute Command Using SSH"),e("OutboundLink")],1)])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SERVER_IP")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.36")]),s._v(".36.55\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("}")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SERVER_IP}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("}")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SERVER_IP}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'echo "hello"; echo "world;"; ls\'')]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("}")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SERVER_IP}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls ~/.ssh | head -1"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("}")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SERVER_IP}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" commands.txt\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -T "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("}")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SERVER_IP}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOL\'\n  now="$(date)"\n  name="$HOSTNAME"\n  up="$(uptime)"\n  echo "Server name is $name"\n  echo "Server date and time is $now"\n  echo "Server uptime: $up"\n  echo "Bye"\nEOL')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h2",{attrs:{id:"how-can-i-avoid-ssh-s-host-verification-for-known-hosts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-can-i-avoid-ssh-s-host-verification-for-known-hosts"}},[s._v("#")]),s._v(" How can I avoid SSH's host verification for known hosts?")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://superuser.com/questions/125324/how-can-i-avoid-sshs-host-verification-for-known-hosts",target:"_blank",rel:"noopener noreferrer"}},[s._v("How can I avoid SSH's host verification for known hosts?"),e("OutboundLink")],1)])]),s._v(" "),e("p",[s._v("当你使用 SSH 连接到一台机器时，首次连接时会提示是否信任该机器的主机密钥。这是 SSH 的安全特性，用于确保你连接到的机器是你期望的机器，以防止中间人攻击。")]),s._v(" "),e("p",[s._v("如果你在脚本中使用 SSH 连接，并且不希望出现人工干预的提示，可以通过以下几种方式解决：")]),s._v(" "),e("ol",[e("li",[s._v("使用 SSH 参数自动接受密钥：你可以在 SSH 命令中使用 StrictHostKeyChecking 参数来禁用主机密钥验证")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -o "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"StrictHostKeyChecking no"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("}")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SERVER_IP}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("通过配置文件来设置")])]),s._v(" "),e("p",[e("code",[s._v("less ~/.ssh/config")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("Host "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v("\n    StrictHostKeyChecking no\n    "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UserKnownHostsFile")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/null\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("Host dev\n    HostName dev.example.com\n    User john\n    Port "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2322")]),s._v("\n    StrictHostKeyChecking no\n    "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UserKnownHostsFile")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/null\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("将 "),e("code",[s._v("hostname")]),s._v(" 替换为你要连接的实际主机名。这将禁用该主机的主机密钥验证，并将已知主机文件设置为"),e("code",[s._v("/dev/null")]),s._v("，这样就不会存储已知主机密钥。")]),s._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[s._v("预先设置已知主机密钥：如果你知道要连接的主机的公钥指纹，你可以将其添加到已知主机文件（通常位于"),e("code",[s._v("~/.ssh/known_hosts")]),s._v("）中，这样 SSH 连接时就不会再提示你是否信任该主机。你可以使用 "),e("code",[s._v("ssh-keyscan")]),s._v(" 工具来获取主机的公钥指纹并将其添加到已知主机文件中")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("ssh-keyscan -H "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.ssh/known_hosts\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);